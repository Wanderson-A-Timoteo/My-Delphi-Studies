unit mkm_layout; // v. 3.2.0.7

interface

uses
    System.SysUtils, System.Classes ,       System.TypInfo, JSON, DBXJSON, DBXJSONReflect,
    System.DateUtils, math, System.Rtti, System.StrUtils, Vcl.Graphics,
    Controls,
    // feedback: Mesut from Turkey
    {$ifdef LINUX}
    System.UIConsts,
    {$endif}
    uconsts,
    uniGUIBaseClasses, uniGUIClasses, uniGUITypes, uniGUIJSUtils, Vcl.forms,
    uniComboBox, uniDBComboBox,uniDBLookupComboBox, uniDateTimePicker, uniDBDateTimePicker,  uniListBox,
    uniBitBtn, uniButton, uniEdit, UniDBEdit, UniSpeedButton, uniGUIFrame, uniGUIForm,  uniGUIDialogs, Messages,
    uniGUIAbstractClasses,  uniGUIApplication, uniPanel, IniFiles, UniImage, uniLabel,  Unipagecontrol,
    uniMemo, uniDBMemo, uniGUIRegClasses, uniDBNavigator, uniScrollBox,
    UniDBRadioGroup, uniDBCheckBox, uniDBImage, uniDBText, uniHTMLFrame, uniURLFrame,
    FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
    FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
    FireDAC.Stan.Async, FireDAC.DApt, Data.DB, FireDAC.Comp.DataSet,
    FireDAC.Comp.Client;

    // transferido de dm_rc
    // adiciona uma classe CSS
    procedure rc_AddCssClass(pObj: TObject; pCls: string);
    procedure rc_RemoveCssClass(pObj: TObject; pCls: string);
    // alinhamento do label vertical centralizado + horizontal
    // left-center   center  right-center
    procedure rc_AlignLabel( pLabel : TUniLabel ; pAlign : string = 'left-center' );
    function  rc_FindControl( pName: string; pForm : TObject = nil ): TUniControl;
    function  rc_FindAllComponents( pForm : TObject; pCriteria : string ) : TStringList;
    function  rc_GetHintProperty( pProp, pProps : string; bParam : boolean = false; bFullLength:boolean = false ) : string;
    function  rc_SetHintProperty( pContent, pProp, pProps : string; pAdd : boolean = false ) : string;
    function  rc_AddHintProperty( pContent, pProps : string; pUpdate : boolean = false ) : string;
    function  rc_NormalizeHintProperty( pContent: string): string;
    function  rc_NormalizeAllTrim( pContent, pToken : string ) : string;
    function  rc_PosHintProperty( pProp, pContent: string): integer;

    procedure rc_CenterObj( pObj : TObject ; pObjParent : TObject = nil ;pV : boolean = true; pH : boolean = true; pV_OffSet : integer = 0; pH_OffSet : integer = 0 );
    procedure rc_AdjustFormsSize( pMainMenu : TObject = nil; pResizeBlocks : boolean = true );
    procedure rc_BootStrapRenderExecute( pForm : TObject = nil; pUpdateDBFields : Boolean  = false; pTabIni : integer = 0; pTabEnd : integer = 0; pMobileScreen : boolean = false; pLandScape : boolean = false; pOnlyThisObj : TObject = nil );
    procedure rc_AdjustEditColorsExecute( pForm : TObject; pAPP_FONT, pEDLKP_COLOR, pEDLKP_FONT_COLOR, pEDIT_COLOR, pEDIT_FONT_COLOR, pEDIT_FOCUS_COLOR : String );
    procedure rc_RenderControlsExecute(pForm: TObject; pMENU_COLOR : string );
    procedure rc_DynamicAlignment( pFrame: TObject );

    //procedure rc_GetLeftPosition( pForm, pObj: TObject ) : string;
    //procedure rc_GetTopPosition( pForm, pObj: TObject ) : string;
    procedure rc_SetPosition( pForm, pObj: TObject; pX, pY : string );
    procedure rc_ScreenAdjustMobileKeyboard( pForm : TObject; pOffSetV : Integer = 0; pOffSetH : Integer = 0 );

    procedure rc_RenderLayout(pForm: TObject; pAdjustFormSize : boolean = false ; pResizeBlocks : boolean = false; pMainMenuExists : boolean = true; pUpdateDBGrids : boolean = true  );
    // v. 3.2.0.4 // Thanks to JOAS // Renamed from GetRCBlocks(pFrame: TObject);
    procedure rc_GenerateRuntimeDebugBlocksFile(pFrame: TObject);

    procedure rc_Collapse( Sender, pForm : TObject; pObj : TUniControl );

implementation

uses untdm_rc, str_func, mkm_func_web, MainModule, Main, mkm_gridblock, mkm_qrcode;

procedure rc_RenderLayout( pForm: TObject; pAdjustFormSize : boolean ; pResizeBlocks : boolean ; pMainMenuExists : boolean ; pUpdateDBGrids : boolean );
var
   oMainMenu : TObject;
   bModal    : boolean;
   cHint     : string;
begin
    bModal := false;
    if pForm is TUniForm then
       TUniForm( pForm ).RTL := mm.RTL
    else
       TUniFrame( pForm ).RTL := mm.RTL;

    {$IFDEF RELEASE}
    dm_rc.rc_ProtectForm( pForm );
    {$ENDIF}

    UniSession.SuspendLayouts;
    try
        // para quando um FORM MODAL estiver ativo, não executar o "dbGridUpdate" no que estiver "abaixo" do MODAL
        mm.varC_Form_Modal := nil;
        if pForm is TUniForm then
        begin
           if mm.CONFIG_LAYOUT_ROUND_EDIT = 'ON' then
              rc_AddCssClass( pForm, 'form-rounded' );

           if Pos( 'modal:' , TUniForm( pForm ).Hint ) > 0 then
              mm.varC_Form_Modal := TUniForm( pForm );
        end;

        oMainMenu := nil;

        cHint     := rc_NormalizeHintProperty( TUniControl( pForm ).Hint );

        if ( lowercase( TUniControl( pForm ).name ) = 'mainform' ) or
           ( lowercase( TUniControl( pForm ).name ) = 'mf' ) then
           pMainMenuExists := false;

        oMainMenu := dm_rc.rc_ScreenUpdate( pMainMenuExists );

        if ( pForm is TUniForm ) then
           bModal := Pos( 'modal:' , cHint ) > 0 ;

        // se for MODAL não precisa dar o 'offset' do mainmenu
        if bModal then
           oMainMenu := nil;

        if ( not bModal ) and ( pForm is TUniForm ) then
        begin
           if Pos( 'width:max', cHint ) > 0 then
           begin
             if oMainMenu = nil then
                TUniControl( pForm ).Width := mm.varI_ScreenWidth
             else
                TUniControl( pForm ).Width := mm.varI_ScreenWidth - TUniControl( oMainMenu ).Width;
           end;

           if Pos( 'height:max', cHint ) > 0 then
              TUniControl( pForm ).Height  := mm.varI_ScreenHeight;
        end;

        if pAdjustFormSize then
           if bModal then
              rc_AdjustFormsSize( nil, pResizeBlocks )
           else
              rc_AdjustFormsSize( oMainMenu , pResizeBlocks );

        dm_rc.rc_AdjustEditColors ( pForm );
        dm_rc.rc_RenderControls( pForm );

        if not pResizeBlocks then
        begin
           dm_rc.rc_BootStrapRender( pForm );
        end;

        if pUpdateDBGrids then
           dm_rc.rc_DBGridUpdateAll( pForm );
    finally
           UniSession.ResumeLayouts;
    end;
end;

function rc_FindControl( pName: string; pForm : TObject ): TUniControl;
begin
     Result := nil;
     if UniApplication.FindComponent('MainForm' ) <> nil then
        if pForm = nil then pForm := MainForm;

     if pForm <> nil then
     begin
        Result := TUniControl( TComponent( pForm ).FindComponent( pName ) );

        if Result = nil then
           Result := TUniControl( UniApplication.FindComponent( pName ) );
     end;
end;

function rc_FindAllComponents(pForm: TObject; pCriteria: string): TStringList;
var
  i : Integer;
  sl : TStringList;
begin
  sl := TStringList.Create;

  Try
     if pForm is TUniForm then
     begin
        for i := 0 to TUniForm( pForm ).ComponentCount - 1 do
        begin
           if Pos( lowercase( pCriteria ), lowercase( TUniForm( pForm ).Components[ i ].Name ) ) > 0 then
           begin
                sl.Add( TUniForm( pForm ).Components[ i ].Name );
           end;
        end;
     end
     else
     if pForm is TUniFrame then
     begin
        for i := 0 to TUniFrame( pForm ).ComponentCount - 1 do
        begin
           if Pos( lowercase( pCriteria ), lowercase( TUniFrame( pForm ).Components[ i ].Name ) ) > 0 then
           begin
                sl.Add( TUniFrame( pForm ).Components[ i ].Name );
           end;
        end;
     end;
  Finally
        Result := sl;
  End;
end;

function rc_GetHintProperty(pProp, pProps: string; bParam : boolean; bFullLength:boolean ): string;
var
   cTmp : string;
   iPos : integer;
begin
    cTmp := rc_NormalizeHintProperty( pProps );
    iPos := rc_PosHintProperty( pProp, cTmp );

    if iPos > 0 then
    begin
       cTmp := Trim( Copy( cTmp, iPos , 200 ) ) + '.$%¨&*.';
       if Pos( '|', cTmp ) > 0 then
          cTmp := Trim( Copy( cTmp, 1, Pos( '|', cTmp ) - 1 ) )
       else
          cTmp := Trim( Copy( cTmp, 1, Pos( '.$%¨&*.', cTmp ) - 1 ) );

       cTmp := Trim( StringReplace( cTmp , pProp, '', [rfReplaceAll] ) );

       if bParam then
          if not bFullLength then
          begin

             if Pos( ':', cTmp ) > 0 then
             begin
                cTmp := ReverseStr( Copy( cTmp, 1, Pos( ':', cTmp ) ) );
                cTmp := Trim( ReverseStr( Copy( cTmp, Pos( ' ', cTmp ) ) ) );
             end
             else
             if Pos( '-', cTmp ) > 0 then
             begin
                cTmp := ReverseStr( Copy( cTmp, 1, Pos( '-', cTmp ) ) );
                cTmp := Trim( ReverseStr( Copy( cTmp, Pos( ' ', cTmp ) ) ) );
             end
             else
                cTmp := Trim( Copy( cTmp, 1, Pos( ' ' , cTmp + ' ' ) ) );
          end
          else
          begin
               cTmp := Trim( Copy( cTmp, 1, 1000 ) );
               if Pos( '|', cTmp ) > 0 then
                  cTmp := Trim( Copy( cTmp, 1, Pos( '|', cTmp )-1 ) );
          end;
    end
    else
       cTmp := '';

    // algumas propriedades não precisam de valores, entao, assumem um DEFAULT de acordo com seu contexto
    //
    // Ex: edLKPTABLE_SetDS_FieldName( veja um exemplo no "frmCadCLIENTES" - campo: edLkpCIDADES_SetDS_CodiIbge )
    //
    //       [[saveto:field]] -> salvar conteudo de "FieldName" no campo "field"
    //       [[saveto:]]      -> salvar conteudo de "FieldName" no campo de próprio nome do lookup, ou seja, "FieldName"
    //
    //   quando ocorrer isso, será retornado pela função o conteúdo "_default" para ser tratado no seu código.
    //
    // some properties don't need values, so they take a DEFAULT according to their context
    //
    // Ex: edLKPTABLE_SetDS_FieldName (see an example in "frmCadCLIENTES" - field: edLkpCIDADES_SetDS_CodiIbge)
    //
    // [[saveto: field]] -> save content from "FieldName" in field "field"
    // [[saveto:]] -> save "FieldName" content in the lookup's own name field, that is, "FieldName"
    //
    // when this occurs, the function will return the content "_default" to be treated in your code.
    //
    if ( iPos > 0 ) then
    begin
       if ( cTmp = '' ) and ( pProp = 'saveto:' ) then
          Result := '_default'
       else
          Result := cTmp;
    end
    else
       Result := '';
end;

function rc_SetHintProperty( pContent, pProp, pProps: string; pAdd : boolean) : string;
var
   cTmp, cTmp2 : string;
   iPos : integer;
begin
    cTmp2 := rc_NormalizeHintProperty( pProps );
    //cTmp2 := pProps;
    //cTmp2 := Trim( StringReplace( cTmp2 , ']]', '', [rfReplaceAll] ) );
    //cTmp2 := Trim( StringReplace( cTmp2 , '[[', '', [rfReplaceAll] ) );

    iPos := rc_PosHintProperty( pProp, cTmp2 );

    if iPos > 0 then
    begin
       cTmp := Trim( Copy( cTmp2, iPos , 200 ) ) + '.$%¨&*.';
       if Pos( '|', cTmp ) > 0 then
          cTmp := Trim( Copy( cTmp, 1, Pos( '|', cTmp ) - 1 ) )
       else
          cTmp := Trim( Copy( cTmp, 1, Pos( '.$%¨&*.', cTmp ) - 1 ) );

       if pAdd then
          cTmp2 := Trim( StringReplace( cTmp2 , cTmp, cTmp + pContent, [rfReplaceAll] ) )
       else
          cTmp2 := Trim( StringReplace( cTmp2 , cTmp, pProp + pContent, [rfReplaceAll] ) );
    end
    else
    if ( cTmp2 <> '' ) then
        cTmp2 := cTmp2 + '|' + pProp + pContent
    else
       cTmp2 := pProp + pContent ;

    Result := '[[' + cTmp2 + ']]';
end;

function rc_AddHintProperty( pContent, pProps : string; pUpdate : boolean ) : string;
var
   cTmp : string;
begin
    cTmp := pProps;
    if Copy( cTmp, 1, 2 ) = '[[' then
       cTmp := Copy( cTmp, 3, 2000 );
    if Copy( ReverseString( cTmp ), 1, 2 ) = ']]' then
       cTmp := Copy( cTmp, 1, Length( cTmp ) - 2 );

    Result := '[[' + cTmp;

    if pUpdate then
       Result := Result + pContent ;

    Result := Result + ']]';
end;

function rc_NormalizeAllTrim( pContent, pToken : string): string;
begin
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '      ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '      ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '     ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '     ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '    ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '    ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '   ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '   ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '  ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '  ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + ' ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + ' ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ' + pToken + '', pToken, [rfReplaceAll] ) );

       pContent := Trim( StringReplace( pContent , ' ' + pToken + '      ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '      ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '     ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '     ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '    ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '    ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '   ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '   ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '  ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '  ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + ' ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + ' ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' ' + pToken + '', pToken, [rfReplaceAll] ) );

       pContent := Trim( StringReplace( pContent , pToken + '      ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '      ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '     ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '     ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '    ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '    ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '   ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '   ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '  ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + '  ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + ' ', pToken, [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , pToken + ' ', pToken, [rfReplaceAll] ) );

       Result := pContent;
end;

function rc_NormalizeHintProperty(pContent: string): string;
begin
    //if Pos( '[[', pContent ) > 0 then
    if Copy( pContent, 1, 2 ) = '[[' then
    begin
       pContent := RemoveLineBreaks( Trim( pContent ) );
       pContent := Trim( StringReplace( pContent , '[[     ', '[[', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '[[    ', '[[', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '[[  ', '[[', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '[[ ', '[[', [rfReplaceAll] ) );

       pContent := Trim( StringReplace( pContent , '     ]]', ']]', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '    ]]', ']]', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '   ]]', ']]', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  ]]', ']]', [rfReplaceAll] ) );

       //if Copy( pContent, 1, 2 ) = '[[' then
          pContent := Copy( pContent, 3, 2000 );

       //if Copy( ReverseStr(pContent), 1, 2 ) = ']]' then
          pContent := Copy( pContent, 1, length( pContent ) - 2 );
       //else
       //   pContent := Copy( pContent, 1, length( pContent ) - 1 );

       pContent := Trim( StringReplace( pContent , '|   ', '|', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '   |', '|', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '|  ', '|', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '  |', '|', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' | ', '|', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , '| ', '|', [rfReplaceAll] ) );
       pContent := Trim( StringReplace( pContent , ' |', '|', [rfReplaceAll] ) );

    end;

    Result := pContent;
end;

function rc_PosHintProperty( pProp, pContent: string): integer;
var
   r,l : integer;
   cTmp, cTmp2 : string;
begin
    r := 0;

    if pContent <> '' then
    begin
       cTmp := pContent;
       cTmp2 := cTmp;

       r := Pos( '[[' + pProp, pContent );

       if ( r = 0 ) then
       begin
          r := Pos( '|' + pProp, pContent );

          if r = 0 then
          begin
             r := Pos( ' ' + pProp, pContent );

             if r = 0 then
             begin
                l := Pos( pProp, pContent );

                if l > 1 then
                begin
                   cTmp2 := Copy( pContent, l-1, 100 );

                   if Copy( cTmp2, 1, 1 ) <> Copy( pProp, 1, 1 ) then
                      r := 0
                   else
                      r := Pos( pProp, cTmp2 );
                end
                else
                    r := l;
             end
             else
                 r := r + 1;
          end
          else
              r := r + 1;
       end
       else
           r := r + 2;
    end;

    result := r;
end;

procedure rc_AddCssClass(pObj: TObject; pCls: string);
begin
     if pObj is TUniForm then
        TUniForm( pObj ).WebForm.JSInterface.JSCall( 'addCls' , [ pCls ])
     else
        TUniControl( pObj ).JSInterface.JSCall( 'addCls' , [ pCls ]);
end;

procedure rc_RemoveCssClass(pObj: TObject; pCls: string);
begin
    if pObj is TUniForm then
       TUniForm( pObj ).WebForm.JSInterface.JSCall( 'removeCls' , [ pCls ])
    else
       TUniControl( pObj ).JSInterface.JSCall( 'removeCls' , [ pCls ]);
end;

procedure rc_AlignLabel(pLabel: TUniLabel; pAlign: string);
begin
     rc_AddCssClass( pLabel, 'align-label-' + pAlign );
end;

procedure rc_ScreenAdjustMobileKeyboard( pForm : TObject; pOffSetV, pOffSetH : Integer );
begin
     if ( mm.varB_Mobile_Screen_Portrait ) then
        TUniControl( pForm ).Top := TUniControl( pForm ).Top - pOffSetV
     else
     if ( mm.varB_Mobile_Screen_Landscape ) then
        TUniControl( pForm ).Top := TUniControl( pForm ).Top - pOffSetH;
end;

procedure rc_SetPosition( pForm, pObj: TObject; pX, pY : string );
var
   cLeft,
   cTop,
   cJs,
   cId : string;
begin
     if pObj is TUniForm then
        cId := TUniForm( pObj ).WebForm.JSId
     else
        cId := TUniControl(pObj).JSId;

     cLeft := '';
     cTop  := '';
     cJs   := '';

     if pX <> '' then
        cLeft := 'left: "' + pX + 'px"';

     if pY <> '' then
        cTop := 'top: "' + pY + 'px"';

     if cLeft + cTop <> '' then
        cJs := '$("#' + cId + '").css( { ';

     if cLeft <> '' then
        cJs := cJs + cLeft;

     if cTop <> '' then
        cJs := cJs + IfThen( cLeft <> '', ',', '' ) + cTop;

     if cJs <> '' then
        UniSession.AddJS( cJs + '} );' ) ;
     //UniSession.AddJS( '$("#' + cId + '").css( { left: "200px", top: "200px" } );' ) ;

     UniSession.AddJS(
       'ajaxRequest( ' + MainForm.htmlFrame.JSName + ' , "_SetPosLeft", ' +
       '["form=" + ' + QuotedStr( TComponent(pForm).Name ) + ', ' +
       '"pleft=" + ' + QuotedStr( pX ) + ', ' +
       '"ptop=" + ' + QuotedStr( pX ) + '] );' );


     //rc_GetLeftPosition( oObj );

     Exit;

     uniSession.AddJS(
                    //$('#block').offset().left
        ' var p = document.getElementById("' + cId + '").position();' +
        ' var x =  ' + //  p.left; '+
        ' var y = p.top; ' +
//        ' var x = document.getElementById("' + cId + '").offsetLeft;' +
//        ' var y = document.getElementById("' + cId + '").offsetTop;' +

        IfThen( pX <> '', ' x = x + ' + pX + '; document.getElementById("' + cId + '").style.left = x + "px";' , '' ) +
        IfThen( pY <> '', ' y = y + ' + pY + '; document.getElementById("' + cId + '").style.top = y + "px";' , '' )

     );

end;

procedure rc_AdjustFormsSize( pMainMenu : TObject ; pResizeBlocks : boolean );
var
   oMainMenu ,
   oObj : TUniControl;
   oFrm : TUniForm;

   bHeightMax, bWidthMax,
   bAlignLeft, bAlignRight, bAlignTop, bAlignBottom : Boolean;

   cHint,
   cTmp, cTmp2 : string;

   bModal,
   bFrmAlign,
   bWidthFix,
   bHeightFix :boolean;

   iMaxWidth, iMaxHeight,
   x, y,
   i : integer;
begin
     oMainMenu := TUniControl ( pMainMenu );
     //UniSession.SuspendLayouts();

     // se houver algum FORM filho aberto ajusta dimensões
     if mm.varC_Form_Detail <> nil then
     begin
          oFrm       := TUniFORM( mm.varC_Form_Detail );
          bWidthFix  := false;
          bHeightFix := false;
          iMaxWidth  := 0;
          iMaxHeight := 0;

          cTmp  := '';
          cTmp2 := '';

          if Pos( '[[', TUniForm(oFrm).Hint ) = 0 then
             cTmp2 := '[[';

          //[[height:max]]
          bHeightMax := Pos( 'height:max'  , TUniForm(oFrm).Hint ) > 0 ;
          bWidthMax  := Pos( 'width:max'   , TUniForm(oFrm).Hint ) > 0 ;
          bModal     := Pos( 'modal:'      , TUniForm(oFrm).Hint ) > 0 ;

          //[[frm-align:right]]
          bAlignLeft   := Pos( 'frm-align:left'   , TUniForm(oFrm).Hint ) > 0 ;
          bAlignRight  := Pos( 'frm-align:right'  , TUniForm(oFrm).Hint ) > 0 ;
          bAlignTop    := Pos( 'frm-align:top'    , TUniForm(oFrm).Hint ) > 0 ;
          bAlignBottom := Pos( 'frm-align:bottom' , TUniForm(oFrm).Hint ) > 0 ;

          bFrmAlign    := ( bAlignBottom ) or ( bAlignTop ) or ( bAlignLeft ) or ( bAlignRight ) ;

          if ( Pos( 'width:' , TUniForm(oFrm).Hint ) = 0 )  then
          begin
             if oFrm.Align = alClient then
                cTmp := cTmp + 'width:' + oFrm.Parent.Width.ToString + ' | ' + 'height:' + oFrm.Parent.height.ToString
             else
                 cTmp := cTmp + 'width:' + oFrm.Width.ToString + ' | ' + 'height:' + oFrm.height.ToString;

             TUniForm(oFrm).Hint := StringReplace( TUniForm(oFrm).Hint, '[[', '', [rfReplaceAll] );
             TUniForm(oFrm).Hint := '[[' + cTmp + ' | ' + TUniForm(oFrm).Hint;
          end;

          if Pos( ']]', oFrm.Hint ) = 0 then
             cTmp := cTmp + ']]';

          if ( cTmp2 <> '' ) then
             TUniForm(oFrm).Hint := cTmp2 + cTmp;

          cHint := StringReplace( TUniForm(oFrm).Hint, '[[', '', [rfReplaceAll] );
          cHint := StringReplace( TUniForm(oFrm).Hint, ']]', '', [rfReplaceAll] ) + ' |';

          if ( Pos( 'width:' , cHint ) > 0 )  then
          begin
             cTmp := Copy( cHint, Pos( 'width:' , cHint ), 200 );
             cTmp := Trim( Copy( cTmp, 1, Pos( '|' , cTmp ) ) );
             bWidthFix := ( Pos( ' fix' , cTmp ) > 0 ) or ( Pos( 'width:fix' , cTmp ) > 0 );

             cTmp := Trim( Copy( cTmp, 1, Pos( ' ' , cTmp ) ) );
             iMaxWidth := StrToIntDef( ReturnNumbers( cTmp ), oFrm.Width );
          end;

          if ( Pos( 'height:' , cHint ) > 0 )  then
          begin
             cTmp := Copy( cHint, Pos( 'height:' , cHint ), 200 );
             cTmp := Trim( Copy( cTmp, 1, Pos( '|' , cTmp ) ) );
             bHeightFix := ( Pos( ' fix' , cTmp ) > 0 ) or ( Pos( 'height:fix' , cTmp ) > 0 );

             cTmp := Trim( Copy( cTmp, 1, Pos( ' ' , cTmp ) ) );
             iMaxHeight := StrToIntDef( ReturnNumbers( cTmp ), oFrm.Height );
          end;

          x := oFrm.Left;
          y := oFrm.Top;

          if x > 0 then
             oFrm.Width  := mm.varI_ScreenWidth - ( oFrm.Left * 2 )
          else
             oFrm.Width  := mm.varI_ScreenWidth ;

          if y > 0 then
             oFrm.Height := mm.varI_ScreenHeight - ( oFrm.Top * 2 )
          else
             oFrm.Height := mm.varI_ScreenHeight;

          if bHeightMax then
             oFrm.Height := mm.varI_ScreenHeight;

          if bWidthMax then
             oFrm.Width := mm.varI_ScreenWidth;

          oFrm.Left := ( mm.varI_ScreenWidth div 2 ) - (  oFrm.Width div 2 );
          oFrm.Top  := ( mm.varI_ScreenHeight div 2 ) - (  oFrm.Height div 2 );

          if pResizeBlocks then
             dm_rc.rc_ResizeBlocks( TUniControl(oFrm) );
     end
     else   // Form Detail are MODAL by Default
     begin
        if ( oMainMenu = nil ) then
           if ( UniApplication.FindComponent('MainForm' ) <> nil )  then
              oMainMenu := rc_FindControl( 'paLayoutMainMenu' );
     end;

     for I := 0 to UniApplication.ComponentCount - 1 do
     begin
         if ( UniApplication.Components[i] is TUniForm ) then
         begin
             oObj  := TUniControl( UniApplication.Components[i] );
             oFrm  := TUniForm( UniApplication.Components[i] );

             if ( oFrm.Name <> 'MainForm' ) then
             begin
                 // [[width:360 fix | height:353 fix]]
                 // [[width:sm-360 md-420 lg-540 | height:sm-353 md-420 lg-540]]  - thinking....
                 bWidthFix  := false;
                 bHeightFix := false;
                 iMaxWidth  := 0;
                 iMaxHeight := 0;

                 cTmp  := '';
                 cTmp2 := '';

                 if Pos( '[[', oFrm.Hint ) = 0 then
                    cTmp2 := '[[';

                 //[[height:max]]
                 bHeightMax := Pos( 'height:max'  , TUniForm(oFrm).Hint ) > 0 ;
                 bWidthMax  := Pos( 'width:max'   , TUniForm(oFrm).Hint ) > 0 ;
                 bModal     := Pos( 'modal:'      , TUniForm(oFrm).Hint ) > 0 ;

                 //[[frm-align:right]]
                 bAlignLeft   := Pos( 'frm-align:left'   , TUniForm(oFrm).Hint ) > 0 ;
                 bAlignRight  := Pos( 'frm-align:right'  , TUniForm(oFrm).Hint ) > 0 ;
                 bAlignTop    := Pos( 'frm-align:top'    , TUniForm(oFrm).Hint ) > 0 ;
                 bAlignBottom := Pos( 'frm-align:bottom' , TUniForm(oFrm).Hint ) > 0 ;

                 bFrmAlign    := ( bAlignBottom ) or ( bAlignTop ) or ( bAlignLeft ) or ( bAlignRight ) ;

                 if ( Pos( 'width:' , oFrm.Hint ) = 0 )  then
                 begin
                    if oFrm.Align = alClient then
                       cTmp := cTmp + 'width:' + oFrm.Parent.Width.ToString + ' | ' + 'height:' + oFrm.Parent.height.ToString
                    else
                        cTmp := cTmp + 'width:' + oFrm.Width.ToString + ' | ' + 'height:' + oFrm.height.ToString;

                    oFrm.Hint := StringReplace( oFrm.Hint, '[[', '', [rfReplaceAll] );
                 end
                 else
                     cTmp := oFrm.Hint;

                 if Pos( ']]', oFrm.Hint ) = 0 then
                    cTmp := cTmp + ']]';

                 if ( cTmp2 <> '' ) then
                    oFrm.Hint := cTmp2 + cTmp
                 else
                 if ( cTmp <> '' ) and ( cTmp <> oFrm.Hint ) then
                    oFrm.Hint := cTmp2 + cTmp + ' | ' + oFrm.Hint;

                 if Pos( '[[', oFrm.Hint ) = 0 then
                    oFrm.Hint := '[[' + oFrm.Hint ;

                 cHint := rc_NormalizeHintProperty( oFrm.Hint  );

                 cTmp := rc_GetHintProperty( 'width:', cHint );
                 if cTmp <> '' then
                 begin
                    bWidthFix := ( Pos( 'fix' , cTmp ) > 0 );
                    iMaxWidth := StrToIntDef( ReturnNumbers( cTmp ), oFrm.Width );
                 end;

                 cTmp := rc_GetHintProperty( 'height:', cHint );
                 if cTmp <> '' then
                 begin
                    bHeightFix := ( Pos( 'fix' , cTmp ) > 0 );
                    iMaxHeight := StrToIntDef( ReturnNumbers( cTmp ), oFrm.Height );
                 end;

                 if ( not bHeightMax ) or ( not bWidthMax ) then
                 begin
                    if ( oFrm.Name <> 'frmMessage' ) then
                    begin
                       if mm.varB_Mobile_Screen_Landscape then
                       begin
                          If ( bModal ) or ( bFrmAlign ) then
                          begin
                             if not bWidthFix then
                               oFrm.Width := varIIF( ( iMaxWidth < 500 ), iMaxWidth, 500 )
                             else
                                oFrm.Width := iMaxWidth ;

                             if not bHeightFix then
                                oFrm.Height := mm.varI_ScreenHeight
                             else
                                oFrm.Height := iMaxHeight ;
                          end
                          else
                          begin
                             oFrm.Width  := mm.varI_ScreenWidth;
                             oFrm.Height := iMaxHeight ;
                          end;
                       end
                       else
                       if ( mm.varB_Mobile_Screen ) then
                       begin
                          If ( bModal ) or ( bFrmAlign ) then
                          begin
                             if ( ( not bWidthFix ) and ( not bWidthMax ) ) or ( bWidthMax ) then
                             begin
                               if oMainMenu = nil then
                                  oFrm.Width := mm.varI_ScreenWidth
                               else
                                  oFrm.Width := mm.varI_ScreenWidth - TUniControl( oMainMenu ).Width;
                             end
                             else
                                oFrm.Width := iMaxWidth ;

                             if ( ( not bHeightFix ) and ( not bHeightMax ) ) or ( bHeightMax ) then
                                oFrm.Height := mm.varI_ScreenHeight
                             else
                                oFrm.Height := iMaxHeight ;
                          end
                          else
                          begin
                             oFrm.Width  := mm.varI_ScreenWidth;
                             oFrm.Height := mm.varI_ScreenHeight;
                          end;
                       end
                       else
                       begin
                          If ( bModal ) or ( bFrmAlign ) then
                          begin
                              if iMaxWidth > 0 then
                                 oFrm.Width  := iMaxWidth ;

                              if iMaxHeight > 0 then
                                 oFrm.Height := iMaxHeight ;
                          end
                          else
                          begin
                             If ( bModal ) then
                             begin
                                if UniApplication.FindComponent('MainForm' ) <> nil then
                                begin
                                     oMainMenu := rc_FindControl( 'paLayoutMainMenu' );
                                     if oMainMenu <> nil then
                                     begin
                                        oFrm.Width  := mm.varI_ScreenWidth - TUniControl( oMainMenu ).Width;
                                     end;
                                end
                                else
                                   oFrm.Width  := mm.varI_ScreenWidth;
                             end
                             else
                                oFrm.Width  := mm.varI_ScreenWidth;

                             oFrm.Height := iMaxHeight ;
                          end;
                       end;
                    end
                    else
                    begin
                       if mm.varB_Mobile_Screen_Landscape then
                       begin
                          oFrm.Height:= mm.varI_ScreenHeight - 10;
                       end
                    end;

                    If ( bModal ) or ( bFrmAlign ) then
                    begin
                       if bAlignLeft then
                       begin
                            oFrm.Left := 0;
                            oFrm.Top  := 0;
                       end
                       else
                       if bAlignRight then
                       begin
                            oFrm.Left := ( mm.varI_ScreenWidth ) - oFrm.Width;
                            oFrm.Top  := 0;
                       end
                       else
                       if bAlignTop then
                       begin
                            oFrm.Left := ( mm.varI_ScreenWidth div 2 ) - (  oFrm.Width div 2 );
                            oFrm.Top  := 0;
                       end
                       else
                       if bAlignBottom then
                       begin
                            oFrm.Left := ( mm.varI_ScreenWidth div 2 ) - (  oFrm.Width div 2 );
                            oFrm.Top  := ( mm.varI_ScreenHeight ) - oFrm.Height;
                       end
                       else
                       begin
                          oFrm.Left := ( mm.varI_ScreenWidth div 2 ) - (  oFrm.Width div 2 );
                          oFrm.Top  := ( mm.varI_ScreenHeight div 2 ) - (  oFrm.Height div 2 );
                       end;
                    end
                    else
                    begin
                       oFrm.Left := 0;
                       oFrm.Top  := 0;
                    end;
                 end;

                 if bHeightMax then
                    oFrm.Height := mm.varI_ScreenHeight;

                 if bWidthMax then
                    if oMainMenu = nil then
                       oFrm.Width := mm.varI_ScreenWidth
                    else
                       oFrm.Width := mm.varI_ScreenWidth - TUniControl( oMainMenu ).Width;

                 if pResizeBlocks then
                   dm_rc.rc_ResizeBlocks( TUniControl(oObj), bModal );
             end;
         end;
     end;
     //UniSession.ResumeLayouts();
end;

procedure rc_AdjustEditColorsExecute( pForm : TObject; pAPP_FONT, pEDLKP_COLOR, pEDLKP_FONT_COLOR, pEDIT_COLOR, pEDIT_FONT_COLOR, pEDIT_FOCUS_COLOR : String );
var
   I : integer;
   tComp : TComponent;
   cTemp : char;
   cTmp : string;
begin
     //UniSession.SuspendLayouts();
    tComp := nil;
    try
       for I := 0 to TComponent( pForm ).ComponentCount - 1 do
       begin
          tComp := TComponent( pForm ).Components[I];

          If ( Pos( 'TAction' , TComponent( pForm ).Components[I].ClassName ) = 0 ) then
          begin
             If GetPropInfo( tComp.ClassInfo, 'Hint') <> nil then
             begin
                if ( Pos( '[[', TUniControl( tComp ).hint ) > 0 ) then
                begin
                   TUniControl( tComp ).hint := '[[' + rc_NormalizeHintProperty( TUniControl( tComp ).hint ) + ']]';
                end;
             end;

             if ( tComp is TUniButton ) or ( tComp is TUniSpeedButton ) Then
             begin
                   if mm.CONFIG_LAYOUT_APPLY_FONT_ALL = 'ON' then
                      TUniButton( TComponent( pForm ).Components[I] ).Font.Name  := pAPP_FONT;
             end
             else
             if ( tComp is TUniLabel ) Then
             begin
                   if mm.CONFIG_LAYOUT_APPLY_FONT_ALL = 'ON' then
                      TUniLabel( TComponent( pForm ).Components[I] ).Font.Name  := pAPP_FONT;
             end
             else
             if ( tComp is TUniListBox ) Then
             begin
                   if mm.CONFIG_LAYOUT_APPLY_FONT_ALL = 'ON' then
                      TUniListBox( TComponent( pForm ).Components[I] ).Font.Name  := pAPP_FONT;

                   TUniListBox( TComponent( pForm ).Components[I] ).Font.Size  := 10;
             end
             else
             if ( tComp is TUniEdit ) OR
                ( tComp is TUniDBEdit ) OR
                ( tComp is TUniMemo ) OR
                ( tComp is TUniDBMemo ) OR
                ( tComp is TUniComboBox ) OR
                ( tComp is TUniDBComboBox ) OR
                ( tComp is TUniDBLookupComboBox ) OR
                ( tComp is TUniDateTimePicker ) OR
                ( tComp is TUniDBDateTimePicker ) OR
                ( tComp is TUniCustomDBEdit ) Then
             begin
                //lookups( nao alterar a cor do FOCO - vc pode mudar isso... )
                if ( lowercase( Copy( TUniDBEdit( TComponent( pForm ).Components[I] ).Name , 1, 5 ) ) = 'edlkp' ) and
                   ( ( tComp is TUniDBEdit ) and
                     ( Pos( '_pesqextra' , lowercase( TUniDBEdit( TComponent( pForm ).Components[I] ).Name ) ) = 0 ) and
                     ( Pos( '_codid' , lowercase( TUniDBEdit( TComponent( pForm ).Components[I] ).Name ) ) = 0 ) ) then
                begin
                   TUniDBEdit( TComponent( pForm ).Components[I] ).ReadOnly   := True;
                   TUniDBEdit( TComponent( pForm ).Components[I] ).Color      := StringToColor( pEDLKP_COLOR );
                   TUniDBEdit( TComponent( pForm ).Components[I] ).Font.Color := StringToColor( pEDLKP_FONT_COLOR );

                   if mm.CONFIG_LAYOUT_APPLY_FONT_ALL = 'ON' then
                      TUniDBEdit( TComponent( pForm ).Components[I] ).Font.Name  := pAPP_FONT;
                end
                else
                begin
                   cTemp := #32;
                   if GetPropInfo( TUniEdit( TComponent( pForm ).Components[I] ).ClassInfo, 'PasswordChar' ) <> nil then
                      cTemp := TUniEdit( TComponent( pForm ).Components[I] ).PasswordChar ;

                   if TUniEdit( TComponent( pForm ).Components[I] ).ReadOnly then
                      TUniEdit( TComponent( pForm ).Components[I] ).Color := $00d0d0d0  // adicionar ao controle de temas no futuro
                   else
                       TUniEdit( TComponent( pForm ).Components[I] ).Color  := StringToColor( pEDIT_COLOR );

                   TUniEdit( TComponent( pForm ).Components[I] ).Font.Color := StringToColor( pEDIT_FONT_COLOR );

                   if mm.CONFIG_LAYOUT_APPLY_FONT_ALL = 'ON' then
                      TUniEdit( TComponent( pForm ).Components[I] ).Font.Name  := pAPP_FONT;

                   if cTemp = '*' then
                   begin
                      TUniEdit( TComponent( pForm ).Components[I] ).PasswordChar := cTemp;
                   end;

                   if not TUniEdit( TComponent( pForm ).Components[I] ).ReadOnly then
                   begin
                      if Pos( 'focus-color:off' , TUniEdit( TComponent( pForm ).Components[I] ).Hint ) = 0 then
                      begin
                         TUniControl( TComponent( pForm ).Components[I] ).ClientEvents.ExtEvents.Values['onfocus'] :=
                            'function focus(sender, eOpts)'+
                            '{  document.getElementById(sender.getInputId( )).style.backgroundColor = "' + ColorToHtml( StringToColor( pEDIT_FOCUS_COLOR ) ) + '";' + //    "#ffffff";'+
                            '   document.getElementById(sender.getInputId( )).style.color = "' + ColorToHtml( StringToColor( pEDIT_FONT_COLOR ) ) + '";' +

                            //'UniSession.AddJS('$("input").attr("autocomplete", "off");');' +

                            '   ajaxRequest( ' + mm.varC_JSNAME_HTMLFRAME + '  , "_onFocus", ' +
                            '                [ ' +
                            '                "pform=" + ' + QuotedStr( TComponent( pForm ).Name ) + ', ' +
                            '                "pobj=" + ' + QuotedStr( TUniControl( TComponent( pForm ).Components[I] ).Name ) +
                            '                ]);' +
                            '}';

                         TUniControl( TComponent( pForm ).Components[I] ).ClientEvents.ExtEvents.Values['onblur'] :=
                            'function focusout(sender, eOpts)'+
                            '{  document.getElementById(sender.getInputId( )).style.backgroundColor = "' + ColorToHtml( StringToColor( pEDIT_COLOR ) ) + '";'+
                            '   document.getElementById(sender.getInputId( )).style.color = "' + ColorToHtml( StringToColor( pEDIT_FONT_COLOR ) ) + '";' +

                            '   ajaxRequest( ' + mm.varC_JSNAME_HTMLFRAME + '  , "_onBlur", ' +
                            '                [ ' +
                            '                "pform=" + ' + QuotedStr( TComponent( pForm ).Name ) + ', ' +
                            '                "pobj=" + ' + QuotedStr( TUniControl( TComponent( pForm ).Components[I] ).Name ) +
                            '                ]);' +
                            '}';
                      end
                      else
                      begin
                         TUniControl( TComponent( pForm ).Components[I] ).ClientEvents.ExtEvents.Values['onfocus'] :=
                            'function focus(sender, eOpts)'+
                            '{  ajaxRequest( ' + mm.varC_JSNAME_HTMLFRAME + '  , "_onFocus", ' +
                            '                [ ' +
                            '                "pform=" + ' + QuotedStr( TComponent( pForm ).Name ) + ', ' +
                            '                "pobj=" + ' + QuotedStr( TUniControl( TComponent( pForm ).Components[I] ).Name ) +
                            '                ]);' +
                            '}';

                         TUniControl( TComponent( pForm ).Components[I] ).ClientEvents.ExtEvents.Values['onblur'] :=
                            'function focusout(sender, eOpts)'+
                            '{  ajaxRequest( ' + mm.varC_JSNAME_HTMLFRAME + '  , "_onBlur", ' +
                            '                [ ' +
                            '                "pform=" + ' + QuotedStr( TComponent( pForm ).Name ) + ', ' +
                            '                "pobj=" + ' + QuotedStr( TUniControl( TComponent( pForm ).Components[I] ).Name ) +
                            '                ]);' +
                            '}';
                      end;
                   end;
                end;

                if ( tComp is TUniMemo ) Then
                begin

                   if Pos( 'focus-color:off' , TUniControl( TComponent( pForm ).Components[I] ).Hint ) = 0 then
                      TUniControl( TComponent( pForm ).Components[I] ).ClientEvents.ExtEvents.Values['afterrender'] :=
                         'function afterrender(sender, eOpts)'+
                         '{  sender.bodyEl.dom.addEventListener( ''keydown'', function(e) {if (e.key==''Enter'') {e.stopPropagation()}} ); }';
                end
                else
                if ( tComp is TUniDBMemo ) Then
                begin
                   if Pos( 'focus-color:off' , TUniControl( TComponent( pForm ).Components[I] ).Hint ) = 0 then
                      TUniControl( TComponent( pForm ).Components[I] ).ClientEvents.ExtEvents.Values['afterrender'] :=
                         'function afterrender(sender, eOpts)'+
                         '{  sender.bodyEl.dom.addEventListener( ''keydown'', function(e) {if (e.key==''Enter'') {e.stopPropagation()}} ); }';
                end;
                // v. 3.1.0.60
                if ( tComp is TUniComboBox ) OR
                   ( tComp is TUniDBComboBox ) OR
                   ( tComp is TUniDBLookupComboBox ) OR
                   ( tComp is TUniDateTimePicker ) OR
                   ( tComp is TUniDBDateTimePicker ) then
                begin
                     if ( tComp is TUniDateTimePicker ) then
                        //rc_AddCssClass( TUniDateTimePicker( tComp ), 'rc-form-text-trigger')
                     else
                     if ( tComp is TUniDBDateTimePicker ) then
                        //rc_AddCssClass( TUniDBDateTimePicker( tComp ), 'rc-form-text-trigger')
                     else
                        rc_AddCssClass( TUniComboBox( tComp ), 'rc-form-text');
                end;
             end;
          end;
       end;
     except on e:exception do
            begin
                 cTmp := '';
                 if tComp <> nil then
                    cTmp := tcomp.Name;

                 ShowMessage( 'rc_AdjustEditColorsExecute' + sLineBreak + sLineBreak +
                              'I=' + i.ToString + sLineBreak + sLineBreak +
                              'Obj:' + cTmp + sLineBreak + sLineBreak +
                              e.Message );
            end;
    end;
     //UniSession.ResumeLayouts();
end;

procedure rc_RenderControlsExecute(pForm: TObject; pMENU_COLOR : string );
var
   iZoom, iPos, iPos2, iFont, iTemp, iMaxWidth, iWidth, iDelay,
   R, I, F : integer;

   vSR: TSearchRec;

   bDots,
   bAppend : boolean;

   cCmd, cLink,
   cHint, cHintDefault, cCaption, cIco, cAlign,
   cTemp, cTemp2, cTemp3, cTemp4,

   cBorder,
   cBorderColor,
   cBorderRadius,
   cBorderRadius_TL,
   cBorderRadius_TR,
   cBorderRadius_BL,
   cBorderRadius_BR,
   cBorderShadow,

   cClass, cClassCaption, cClassIco,
   pTypeButton : string;

   pControl, pBlock : TUniControl;

   oBtn  : TUniSpeedButton;
   oEdit : TObject;

   oUrlFrm : TUniUrlFrame;
   oHtmlFrm : TUniHTMLFrame;
   oQrCodeImg : TUniImage; // v. 3.2.0.0
begin
     pControl := nil;
     //UniSession.SuspendLayouts();
     try
        if lowercase( TComponent( pForm ).Name ) = 'mainform' then
        begin
           if TUniControl( TComponent( pForm ).FindComponent('UniTreeMainMenu')) <> nil then
              TUniControl( TComponent( pForm ).FindComponent('UniTreeMainMenu')).Color := StringToColor( pMENU_COLOR );

           if TUniControl( TComponent( pForm ).FindComponent('paSearchTop')) <> nil then
              TUniControl( TComponent( pForm ).FindComponent('paSearchTop')).Color := StringToColor( pMENU_COLOR );


           if TUniControl( TComponent( pForm ).FindComponent('sboxGridBlock')) <> nil then
              TUniControl( TComponent( pForm ).FindComponent('sboxGridBlock')).Color := StringToColor( mm.CONFIG_LAYOUT_BG_COLOR );
           if TUniControl( TComponent( pForm ).FindComponent('paBS_Tabs')) <> nil then
              TUniControl( TComponent( pForm ).FindComponent('paBS_Tabs')).Color     := StringToColor( mm.CONFIG_LAYOUT_BG_COLOR );
        end;

        // criar componentes...
        for I := 0 to TComponent( pForm ).ComponentCount - 1 do
        begin
           cTemp  := '';
           cTemp2 := '';
           cTemp3 := '';
           cIco   := '';

           cClass        := '';
           cClassCaption := '';
           cClassIco     := '';
           cLink         := '';
           bAppend       := False;
           cCaption      := '';

           pControl := TUniControl( TComponent( pForm ).Components[I] );

           If ( Pos( 'TAction' , TComponent( pForm ).Components[I].ClassName ) = 0 ) then
           begin
             If ( GetPropInfo( TComponent( pForm ).Components[I].ClassInfo, 'Hint') <> nil ) then
             begin
                cHint    := rc_NormalizeHintProperty( TUniControl( TComponent( pForm ).Components[I] ).hint );
             end;

             cHintDefault := cHint;
             // bsToolTip
             if ( Pos( 'hint:' , cHint ) > 0 ) and
                ( ( TComponent( pForm ).Components[I] is TUniControl ) ) then
             begin
                cTemp    := Trim( rc_GetHintProperty( 'hint:', cHintDefault, true, true )); // Trim(Copy( cHintDefault, Pos( 'hint:' , cHintDefault ) + 5 , 200 ))  ;

                // v. 3.2.0.2 - hint
                //hint:Show / Hide Search Dialog title:Search Button
                cCaption := '';
                if Pos( 't:', cHintDefault ) > 0  then
                begin
                     cCaption := rc_GetHintProperty( 't:', cHintDefault, true, false );
                end;
                iWidth := 0;
                if Pos( 'w:', cHintDefault ) > 0  then
                begin
                     cClass := rc_GetHintProperty( 'w:', cHintDefault, true );
                     iWidth := StrToIntDef( cClass, 0 );
                end;
                iDelay := 0;
                if Pos( 'd:', cHintDefault ) > 0  then
                begin
                     cClass := rc_GetHintProperty( 'd:', cHintDefault, true );
                     iDelay := StrToIntDef( cClass, 0 );
                end;

                cAlign        := '';
                if Pos( 'a:', cHintDefault ) > 0  then
                begin
                     cAlign := rc_GetHintProperty( 'a:', cHintDefault, true );
                end;
                if Pos( 'c:', cHintDefault ) > 0  then
                begin
                     cClass := rc_GetHintProperty( 'c:', cHintDefault, true, true );
                end
                else
                  cClass := '';

                cTemp := StringReplace( cTemp, 't:' + cCaption, '', [rfReplaceAll] );
                cTemp := StringReplace( cTemp, 'c:' + cClass, '', [rfReplaceAll] );
                cTemp := StringReplace( cTemp, 'w:' + iwidth.ToString, '', [rfReplaceAll] );
                cTemp := StringReplace( cTemp, 'd:' + iDelay.ToString, '', [rfReplaceAll] );

                TUniControl( TComponent( pForm ).Components[I] ).RTL := mm.RTL;

                //hint:Show / Hide Search Dialog title:Search Button
                TUniControl( TComponent( pForm ).Components[I] ).ClientEvents.ExtEvents.Values['afterrender'] :=
                   'function afterrender(sender, eOpts){'+
                      'Ext.create(''Ext.tip.ToolTip'','+
                      '{  target: sender.getEl(), ' +
                      //'   id : ' + QuotedStr('tooltip-' + TUniControl( TComponent( pForm ).Components[I] ).Name ) + ',' +
                      //'   anchor : ''top'',' + // não consegui ajustar a cor corretamente...fica para uma prox. versão
//                      'closable: true, ' +
//                      'align: ''tl'',' +
//                      'focusOnToFront: true, ' +
//                      'autoHide: true, ' +
//                      'autoShow: true, ' +
//                      'autoScroll: true, ' +
                      //varIIF( cAlign   <> '', ' align: ''' + cAlign + ''',' , '' ) +
                      varIIF( iWidth    > 0 , ' width: ' + iWidth.ToString + ', ' , '' ) + //  + ( Length( cTemp ) * 10 ).ToString + ',' +
                      varIIF( cCaption <> '', ' title: ''' + cCaption + ''',' , '' ) +
                      varIIF( cClass   <> '', ' cls: ''' + cClass + ''',' , '' ) +
                      varIIF( iDelay    > 0 , ' dismissDelay: ' + iDelay.ToString + ', ' , '' ) +
                      '   html: " ' + cTemp + '"})}' ;

                cTemp := '';
             end;

             pTypeButton   := '';
             bAppend       := false;
             cClass        := '';
             cClassCaption := '';
             cClassIco     := '';
             cLink         := '';
             cCaption      := '';

             if ( TComponent( pForm ).Components[I] is TUniContainerPanel ) or ( TComponent( pForm ).Components[I] is TUniPanel ) then
             begin
                // adiciona animacao aos blocos
                cTemp2 := rc_GetHintProperty( 'cols:' , cHint );

                If ( cTemp2 <> '' ) and
                   ( Pos( 'animate:off', cHint ) = 0 ) and
                   ( Pos( ' rc-anim-block-resize', cHint ) = 0 ) and
                   ( mm.CONFIG_LAYOUT_GRIDBLOCK_ANIM = 'ON' ) then
                begin
                    pBlock         := TUniControl( TComponent( pForm ).Components[I] );
                    if ( Pos( 'fade:off', cHint ) > 0 ) then
                       pBlock.Hint    := rc_SetHintProperty( ' rc-anim-block-resize', 'cls:', cHint, True )
                    else
                       pBlock.Hint    := rc_SetHintProperty( ' rc-anim-block-resize rc-fade-in', 'cls:', cHint, True );
                end;
                // PDF
                cTemp2 := rc_GetHintProperty( 'pdf:' , cHint );
                If cTemp2 <> '' then
                begin
                    pBlock         := TUniControl( TComponent( pForm ).Components[I] );
                    oUrlFrm        := TUniURLFrame( TComponent(pForm).FindComponent( 'rcPdfViewer_' + pBlock.Name ) );
                    // v. 3.2.0.9
                    //if oUrlFrm <> nil then
                    //   TUniURLFrame( TComponent(pForm).FindComponent( 'rcPdfViewer_' + pBlock.Name ) ).Free;

                    if oUrlFrm = nil then
                    begin
                       oUrlFrm        := TUniURLFrame.Create( TComponent(pForm) );
                       oUrlFrm.Parent := pBlock;
                       oUrlFrm.Name   := 'rcPdfViewer_' + pBlock.Name;
                    end;

                    if oUrlFrm <> nil then
                    begin
                       oUrlFrm.Left   := 0;
                       oUrlFrm.Top    := 0;
                       oUrlFrm.Height := pBlock.Height;
                       oUrlFrm.Width  := pBlock.Width;

                       // se estiver dentro de um bloco 'responsivo'...
                       oUrlFrm.Anchors:= [ akTop, akLeft, akRight, akBottom];
                       oUrlFrm.URL    := cTemp2;
                    end;
                end;
                // VIDEO
                cTemp2 := rc_GetHintProperty( 'video:' , cHint );
                If cTemp2 <> '' then
                begin
                    pBlock         := TUniControl( TComponent( pForm ).Components[I] );
                    oHtmlFrm       := TUniHTMLFrame( TComponent(pForm).FindComponent( 'rcVideoViewer_' + pBlock.Name ) );
                    // v. 3.2.0.9
                    //if oHtmlFrm <> nil then
                    //   TUniHTMLFrame( TComponent(pForm).FindComponent( 'rcVideoViewer_' + pBlock.Name ) ).Free;
                    // v. 3.2.0.9
                    if oHtmlFrm = nil then
                    begin
                       oHtmlFrm        := TUniHTMLFrame.Create( TComponent(pForm) );
                       oHtmlFrm.Parent := pBlock;
                       oHtmlFrm.Name   := 'rcVideoViewer_' + pBlock.Name;
                    end;
                    // v. 3.2.0.9
                    if oHtmlFrm <> nil then
                    begin
                       oHtmlFrm.Hint   := '[[bsvideo:' + cTemp2 + '|center:parent x]]';
                       // se estiver dentro de um bloco 'responsivo'...
                       oHtmlFrm.Anchors:= [ akTop, akLeft];
                       oHtmlFrm.Left   := 0;
                       oHtmlFrm.Top    := 0;
                    end;
                end;
                // v. 3.2.0.2
                // QR CODE
                cTemp2 := rc_GetHintProperty( 'qrcode:' , cHint );
                If cTemp2 <> '' then
                begin
                    pBlock         := TUniControl( TComponent( pForm ).Components[I] );
                    oQrCodeImg     := TUniImage( TComponent(pForm).FindComponent( 'rcQrCode_' + pBlock.Name ) );
                    // v. 3.2.0.9
                    //if oQrCodeImg <> nil then
                    //begin
                        //FreeAndNil ( TUniImage( TComponent(pForm).FindComponent( 'rcQrCode_' + pBlock.Name ) ) );
                    //end;

                    if oQrCodeImg = nil then
                    begin
                       oQrCodeImg        := TUniImage.Create( TComponent(pForm) );
                       oQrCodeImg.Parent := pBlock;
                       oQrCodeImg.Name   := 'rcQrCode_' + pBlock.Name;
                       oQrCodeImg.Hint   := '[[center:parent xy]]';
                       oQrCodeImg.Stretch:= true;
                       oQrCodeImg.Proportional := true;
                    end;

                    if oQrCodeImg <> nil then
                    begin
                       oQrCodeImg.Left   := 0;
                       oQrCodeImg.Top    := 0;
                       oQrCodeImg.Height := pBlock.Height;
                       oQrCodeImg.Width  := pBlock.Width;

                       // se estiver dentro de um bloco 'responsivo'...
                       //oQrCodeImg.Anchors:= [ akTop, akLeft, akRight, akBottom];
                       rc_QRCode( oQrCodeImg, cTemp2 );
                    end;
                end;
                // IMG
                cTemp2 := rc_GetHintProperty( 'img:' , cHint );
                If cTemp2 <> '' then
                begin
                    pBlock         := TUniControl( TComponent( pForm ).Components[I] );

                    oHtmlFrm       := TUniHTMLFrame( TComponent(pForm).FindComponent( 'rcImgViewer_' + pBlock.Name ) );
                    // v. 3.2.0.9
                    //if oHtmlFrm <> nil then
                    //   TUniHTMLFrame( TComponent(pForm).FindComponent( 'rcImgViewer_' + pBlock.Name ) ).Free;
                    // v. 3.2.0.9
                    if oHtmlFrm = nil then
                    begin
                       oHtmlFrm        := TUniHTMLFrame.Create( TComponent(pForm) );
                       oHtmlFrm.Parent := pBlock;
                       oHtmlFrm.Name   := 'rcImgViewer_' + pBlock.Name;
                       //oHtmlFrm.Hint   := '[[bsimg:' + cTemp2 + '|center:parent xy]]';
                    end;
                    // v. 3.2.0.9
                    if oHtmlFrm <> nil then
                    begin
                       oHtmlFrm.Hint   := '[[bsimg:' + cTemp2 + '|center:parent xy]]';
                       oHtmlFrm.Left   := 0;
                       oHtmlFrm.Top    := 0;
                       oHtmlFrm.Height := pBlock.Height;
                       oHtmlFrm.Width  := pBlock.Width;

                       // se estiver dentro de um bloco 'responsivo'...
                       oHtmlFrm.Anchors:= [ akTop, akLeft, akRight, akBottom];
                    end;
                end;
                // CAROUSEL
                cTemp2 := rc_GetHintProperty( 'carousel:' , cHint );
                If cTemp2 <> '' then
                begin
                    pBlock         := TUniControl( TComponent( pForm ).Components[I] );
                    oHtmlFrm       := TUniHTMLFrame( TComponent(pForm).FindComponent( 'rcCarouselViewer_' + pBlock.Name ) );
                    // v. 3.2.0.9
                    // feedback FABIO OLIVEIRA
                    //if oHtmlFrm <> nil then
                    //   TUniHTMLFrame( TComponent(pForm).FindComponent( 'rcCarouselViewer_' + pBlock.Name ) ).Free;
                    // v. 3.2.0.9
                    if oHtmlFrm = nil then
                    begin
                       oHtmlFrm        := TUniHTMLFrame.Create( TComponent(pForm) );
                       oHtmlFrm.Parent := pBlock;
                       oHtmlFrm.Name   := 'rcCarouselViewer_' + pBlock.Name;
                    end;
                    // v. 3.2.0.9
                    if oHtmlFrm <> nil then
                    begin
                       // imagens
                       cTemp  := cHint;
                       cTemp3 := '';
                       repeat
                             cTemp3 := cTemp3 + 'bscarousel:' + cTemp2 + '|';

                             cTemp := StringReplace( cTemp, 'carousel:' + cTemp2, '', [rfReplaceAll] ) + ' ';

                             cTemp2 := rc_GetHintProperty( 'carousel:' , cTemp );
                       until cTemp2 = '' ;

                       cTemp4 := StringReplace( cTemp3, 'bscarousel:', '', [rfReplaceAll] );
                       cTemp4 := StringReplace( cTemp4, '|', '', [rfReplaceAll] );
                       if Pos( '.', cTemp4 ) = 0 then
                       begin
                          cTemp3 := '';
                          R := FindFirst( cTemp4 + BACKSLASH + '*.*' , faAnyFile, vSR );
                          while R = 0 do
                          begin
                            if ( Pos( '.jpg', vSR.Name ) > 0 ) or
                               ( Pos( '.png', vSR.Name ) > 0 ) or
                               ( Pos( '.bmp', vSR.Name ) > 0 ) then
                               cTemp3 := cTemp3 + 'bscarousel:' + cTemp4 + '/' + vSR.Name + '|';

                            R := FindNext( vSR );
                          end;
                          FindClose(vSR);
                       end;

                       oHtmlFrm.Hint   := '[[' + cTemp3 + 'center:parent xy]]';
                       oHtmlFrm.Left   := 0;
                       oHtmlFrm.Top    := 0;
                       oHtmlFrm.Height := pBlock.Height;
                       oHtmlFrm.Width  := pBlock.Width;

                       // se estiver dentro de um bloco 'responsivo'...
                       oHtmlFrm.Anchors:= [ akTop, akLeft, akRight, akBottom];
                    end;
                end;

                cTemp2 := '';
                cTemp3 := '';
             end
             else
             if ( TComponent( pForm ).Components[I] is TUniEdit ) or
                ( TComponent( pForm ).Components[I] is TUniDBEdit ) then
             begin
                // feedback Mohamed Ammar( testing... )
                //TUniControl( TComponent( pForm ).Components[I] ).RTL := mm.RTL;
                //if ( TComponent( pForm ).Components[I] is TUniDBEdit ) then
                //begin
                //   TUniDBEdit( TComponent( pForm ).Components[I] ).UseFieldAlignment := not mm.RTL;
                //end;

                if rc_PosHintProperty( 'link:' , cHint ) > 0 then
                begin
                   cLink := rc_GetHintProperty( 'link:' , cHint );
                   oEdit := TComponent( pForm ).Components[I];
                   oBtn  := TUniSpeedButton( TComponent(pForm).FindComponent( 'rcBtnLink_' + TUniControl( oEdit ).Name ) );
                   // v. 3.2.0.9
                   if oBtn = nil then
                   begin
                      oBtn              := TUniSpeedButton.Create( TComponent(pForm) );
                      oBtn.Parent       := TUniControl( oEdit ).Parent;
                      oBtn.Name         := 'rcBtnLink_' + TUniControl( oEdit ).Name;

                      // se estiver dentro de um bloco 'responsivo'...
                      if Pos( 'rcblock', lowercase( oBtn.Parent.Name ) ) > 0 then
                         oBtn.Anchors   := [akTop,akRight];

                      TUniControl( oEdit ).Width := TUniControl( oEdit ).Width - 27;
                   end;
                   // v. 3.2.0.9
                   if oBtn <> nil then
                   begin
                      oBtn.Hint         := '[[cls:ButtonThemeCrud | ico:fas-link | link:' + cLink + ']]';
                      TUniControl( oBtn ).TabStop:= false; // v. 3.2.0.7
                      TUniControl( oBtn ).Left   := TUniControl( oEdit ).Left + TUniControl( oEdit ).Width + 2;
                      TUniControl( oBtn ).Top    := TUniControl( oEdit ).Top ;
                      TUniControl( oBtn ).Height := TUniControl( oEdit ).Height;
                      TUniControl( oBtn ).Width  := 25;
                   end;
                end;

                if ( rc_PosHintProperty( 'dial:' , cHint ) > 0 ) then
                begin
                   cLink := rc_GetHintProperty( 'dial:' , cHint );
                   oEdit := TComponent( pForm ).Components[I];
                   oBtn  := TUniSpeedButton( TComponent(pForm).FindComponent( 'rcBtnPhone_' + TUniControl( oEdit ).Name ) );
                   // v. 3.2.0.9
                   if oBtn = nil then
                   begin
                      oBtn              := TUniSpeedButton.Create( TComponent(pForm) );
                      oBtn.Parent       := TUniControl( oEdit ).Parent;
                      oBtn.Name         := 'rcBtnPhone_' + TUniControl( oEdit ).Name;
                      // se estiver dentro de um bloco 'responsivo'...
                      if Pos( 'rcblock', lowercase( oBtn.Parent.Name ) ) > 0 then
                         oBtn.Anchors   := [akTop,akRight];

                      TUniControl( oEdit ).Width := TUniControl( oEdit ).Width - 27;
                   end;
                   // v. 3.2.0.9
                   if oBtn <> nil then
                   begin
                      oBtn.Hint         := '[[cls:ButtonThemeCrud | ico:fas-phone | dial:' + cLink + ']]';
                      TUniControl( oBtn ).TabStop:= false; // v. 3.2.0.7
                      TUniControl( oBtn ).Left   := TUniControl( oEdit ).Left + TUniControl( oEdit ).Width + 2;
                      TUniControl( oBtn ).Top    := TUniControl( oEdit ).Top ;
                      TUniControl( oBtn ).Height := TUniControl( oEdit ).Height;
                      TUniControl( oBtn ).Width  := 25;
                   end;
                end;

                // in development
                if ( rc_PosHintProperty( 'mail:' , cHint ) > 0 ) then
                begin
                   cLink := rc_GetHintProperty( 'mail:' , cHint );
                   oEdit := TComponent( pForm ).Components[I];
                   oBtn  := TUniSpeedButton( TComponent(pForm).FindComponent( 'rcBtnEmail_' + TUniControl( oEdit ).Name ) );
                   // v. 3.2.0.9
                   if oBtn = nil then
                   begin
                      oBtn              := TUniSpeedButton.Create( TComponent(pForm) );
                      oBtn.Parent       := TUniControl( oEdit ).Parent;
                      oBtn.Name         := 'rcBtnEmail_' + TUniControl( oEdit ).Name;
                      // se estiver dentro de um bloco 'responsivo'...
                      if Pos( 'rcblock', lowercase( oBtn.Parent.Name ) ) > 0 then
                         oBtn.Anchors   := [akTop,akRight];

                      TUniControl( oEdit ).Width := TUniControl( oEdit ).Width - 27;

                      //TUniButton( oBtn ).OnClick := dm_rc.DynamicOnClickMail;
                   end;
                   // v. 3.2.0.9
                   if oBtn <> nil then
                   begin
                      oBtn.Hint         := '[[cls:ButtonThemeCrud | ico:fa-envelope | mail:' + cLink + ']]';
                      TUniControl( oBtn ).TabStop:= false; // v. 3.2.0.7
                      TUniControl( oBtn ).Left   := TUniControl( oEdit ).Left + TUniControl( oEdit ).Width + 2;
                      TUniControl( oBtn ).Top    := TUniControl( oEdit ).Top ;
                      TUniControl( oBtn ).Height := TUniControl( oEdit ).Height;
                      TUniControl( oBtn ).Width  := 25;
                   end;
                end;

                // v. 3.1.0.63
//                cTemp := rc_GetHintProperty( 'mask:', TUniControl( TComponent(pForm).Components[I] ).hint ) ;
//                if cTemp <> '' then
//                begin
//                   TUniEdit( TComponent(pForm).Components[I] ).InputType := 'text';
//                   if ( cTemp = 'date' ) or ( cTemp = 'cep' ) or ( cTemp = 'cpf' ) or ( cTemp = 'cnpj' ) then
//                      TUniEdit( TComponent(pForm).Components[I] ).InputType := 'number'
//                   else
//                   if ( cTemp = 'phoneddd' ) or ( cTemp = 'phone' ) then
//                      TUniEdit( TComponent(pForm).Components[I] ).InputType := 'tel'
//                   else
//                      TUniEdit( TComponent(pForm).Components[I] ).InputType := 'text';
//                end;
             end
             else
             if ( TComponent( pForm ).Components[I] is TUniHTMLFrame ) then
             begin
                // QRCODE - bug fix to solve...
//                cTemp2 := rc_GetHintProperty( 'qrcode:' , cHint );
//                If cTemp2 <> '' then
//                begin
//                     oHtmlFrm := TUniHTMLFrame( TComponent( pForm ).Components[I] );
//                     oHtmlFrm.HTML.Text := '<div class="rc-qrcode">' +
//                                           '  <div class="rc-qrcode" id="' + oHtmlFrm.JSId + '"></div>' +
//                                           '</div>';
//                end;
             end;
           end;
        end;

        for I := 0 to TComponent( pForm ).ComponentCount - 1 do
        begin
           cTemp  := '';
           cTemp2 := '';
           cTemp3 := '';
           cIco   := '';

           cClass        := '';
           cClassCaption := '';
           cClassIco     := '';
           cLink         := '';
           bAppend       := False;
           cCaption      := '';

           pControl := TUniControl( TComponent( pForm ).Components[I] );

           If ( Pos( 'TAction' , TComponent( pForm ).Components[I].ClassName ) = 0 ) then
           begin
             If ( GetPropInfo( TComponent( pForm ).Components[I].ClassInfo, 'Hint') <> nil ) then
             begin

                cTemp := rc_GetHintProperty( 'collapse:', pControl.Hint );
                if ( cTemp <> '' ) and ( pos( 'ico:', pControl.Hint ) = 0 ) and ( pos( 'cls:', pControl.Hint ) = 0 ) then
                begin
                     pControl.Hint := rc_AddHintProperty( '|cls:color-black rc-font-size-16 ' +
                                                          'rc-cursor-pointer|' +
                                                          'ico:fas-angle-down', pControl.Hint, true );
//                     TUniLabel(pControl).OnClick := dm_rc.DynamicCollapse;
                end;
                if ( cTemp <> '' ) then
                   TUniLabel(pControl).OnClick := dm_rc.DynamicCollapse;

                cTemp := '';
                cHint    := rc_NormalizeHintProperty( TUniControl( TComponent( pForm ).Components[I] ).hint );
             end;

             If ( TComponent( pForm ).Components[I] is TUniScrollBox ) then
             begin
                  // v. 3.2.0.7
                  If TComponent( pForm ) is TUniForm then
                     If GetPropInfo( TUniScrollBox( TComponent( pForm ).Components[I] ).ClassInfo, 'RetainInitialOffsets') <> nil then
                        TUniScrollBox( TComponent( pForm ).Components[I] ).RetainInitialOffsets := True;

                  TUniScrollBox( TComponent( pForm ).Components[I] ).ScrollTo(0,0);
                  TUniScrollBox( TComponent( pForm ).Components[I] ).DoAlignControls;
             end;

             If ( TComponent( pForm ).Components[I] is TUniEdit ) then
             begin

                     if ( rc_PosHintProperty( 'cls:', cHint ) > 0 ) then
                     begin
                          cClass := rc_GetHintProperty( 'cls:' , cHint );
                     end;

                     if cClass <> '' then
                        TUniControl( TComponent( pForm ).Components[I] ).JSInterface.JSCall( 'addCls' , [ cClass ]);

                     cClass := '';

             end
             else
             If ( TComponent( pForm ).Components[I] is TUniLabel ) then
             begin
                   //[[ico:fa-envelope | cls-ico:align-label-left-center | cls-caption:badge bg-warning | append]]
                   // [[cls:ButtonThemeCrud | ico:fas-angle-left 2x]]
                   //                         ico:fas-angle-left append]]
                   //                         ico:fas-angle-left cls-ico:font-black]]

                  cTemp2 := '';
                  cTemp3 := '';
                  if Trim( cHint ) <> '' then
                  cTemp2 := cHint + '|';

                  cCmd := cTemp2;

                  bAppend := false;

                  iPos2 := Pos( '|' , cTemp2 );
                  if cTemp2 <> '' then
                  begin
                     cTemp  := Trim( Copy( cCmd, 1 , iPos2 ) );
                     cTemp2 := Trim( StringReplace( cCmd, cTemp, '', [rfReplaceAll] ) );

                     cCmd := cTemp2;

                     cTemp  := StringReplace( cTemp, '|', '', [rfReplaceAll] ) + ' ';

                     cTemp := cHint;

                     // append caption if exists
                     if not bAppend then
                        bAppend := rc_PosHintProperty( 'append', cCmd ) > 0;

                     if rc_PosHintProperty( 'label-wrap:', cTemp ) > 0 then
                     begin
                          rc_AddCssClass( TComponent( pForm ).Components[I], 'rc-label-wrap' );
                     end;

                     if ( rc_PosHintProperty( 'ico:', cTemp ) > 0 ) and ( rc_PosHintProperty( 'cls-ico:', cTemp ) > 0 ) then
                     begin
                          cClass := '';
                          cClassCaption := '';
                          cClassIco := '';
                          cIco := rc_GetHintProperty( 'ico:' , cTemp );
                     end;

                     if ( rc_PosHintProperty( 'cls:', cTemp ) > 0 ) then
                     begin
                          cClass := rc_GetHintProperty( 'cls:' , cTemp );
                          cClassCaption := cClass;
                     end;

                     if ( rc_PosHintProperty( 'cls-ico:', cTemp ) > 0 ) then
                     begin
                          cClass := rc_GetHintProperty( 'cls-ico:' , cTemp );
                     end;

                     if ( rc_PosHintProperty( 'ico:', cTemp ) > 0 ) then
                     begin
                          cIco := rc_GetHintProperty( 'ico:' , cTemp );
                     end;

                     if ( rc_PosHintProperty( 'cls-caption:', cTemp ) > 0 ) then
                     begin
                          cClassCaption := cClass + ' ' + rc_GetHintProperty( 'cls-caption:' , cTemp );

                     end;

                     if ( rc_PosHintProperty( 'label-link:', cTemp ) > 0 ) or ( rc_PosHintProperty( 'link:', cTemp ) > 0 ) then
                     begin
                          cLink := rc_GetHintProperty( 'label-link:' , cTemp );
                          if cLink = '' then
                             cLink := rc_GetHintProperty( 'link:' , cTemp );

                          TUniLabel( TComponent( pForm ).Components[I] ).Font.Color := StringToColor( mm.CONFIG_LAYOUT_LINK_COLOR );
                          TUniLabel( TComponent( pForm ).Components[I] ).TextConversion := txtHTML;
                          TUniLabel( TComponent( pForm ).Components[I] ).Caption :=
                            '<a href="' + cLink + '" target="_blank" ' +
                            'onmouseover="this.style.color=''' + ColorToHtml( StringToColor( mm.CONFIG_LAYOUT_LINKHOVER_COLOR ))  + ''';this.style.textDecoration=''none'';" onmouseout="this.style.color=''' + ColorToHtml( TUniLabel( TComponent( pForm ).Components[I] ).Font.Color ) + ''';">' + TUniLabel( TComponent( pForm ).Components[I] ).Caption + '</a>';
                     end;

                     iPos2 := Pos( '|' , cCmd );
                  end;

                  cTemp3 := rc_GetHintProperty( 'ico-stack:' , cHint, true );

                  if cTemp3 <> '' then
                  begin
                     cTemp2 := rc_GetHintProperty( 'cls:' , cHint, true );

                     if cTemp2 = '' then
                        cTemp2 := 'text-primary';

                     TUniControl( TComponent( pForm ).Components[I] ).Caption :=
                         '<span class="fa-stack fa-3x">' +
                         '  <i class="fa fa-circle fa-stack-2x ' + cTemp2 + '"></i>' +
                         '  <i class="fa ' + cTemp3 + ' fa-stack-1x fa-inverse"></i>' +
                         '</span>' ;
                  end
                  else
                  if Trim( cIco ) <> '' then
                  begin
                     // icon type
                     cTemp3  := Copy( cIco , 1, Pos( '-' , cIco ) - 1 ) ;

                     if Copy( cTemp3, 1, 2 ) = 'fa' then
                        cTemp3 := cTemp3 + ' fa-'
                     else
                        cTemp3 := cTemp3 + ' picto-';

                     // icon name
                     cTemp2 := Copy( cIco , Pos( '-' , cIco ) + 1, 100 ) ;

                     // has a zoom ?( font awesome 2x...)
                     iZoom := 1;
                     for f := 1 to 4 do
                     begin
                     if ( Pos( ' ' + f.ToString + 'x' , cHint ) > 0 ) then
                        iZoom := StrToIntDef( ReturnNumbers( Copy( cHint, Pos( ' ' + f.ToString + 'x' , cHint ) , 3 ) ), 0 );
                     end;

                     if iZoom > 0 then
                        cTemp2 := StringReplace( cTemp2, iZoom.ToString + 'x' , '', [rfReplaceAll] );

                     iPos := rc_PosHintProperty( 'caption:' , cHint );

                     if ( bAppend ) and ( iPos = 0 ) then
                     begin
                        cCaption := TUniControl( TComponent( pForm ).Components[I] ).Caption;
                        TUniControl( TComponent( pForm ).Components[I] ).Hint := rc_SetHintProperty( cCaption, 'caption:' ,  cHint  ) ;
                        cHint := rc_NormalizeHintProperty( TUniControl( TComponent( pForm ).Components[I] ).Hint );
                     end
                     else
                     if iPos > 0 then
                     begin
                        cCaption := rc_GetHintProperty( 'caption:' ,  cHint  );
                     end;

                     TUniControl( TComponent( pForm ).Components[I] ).Caption := '<i class="' + cClass + ' ' + cTemp3 + cTemp2 +
                                  varIIF( iZoom > 0 , ' fa-' + iZoom.ToString + 'x' , '' ) + '"></i>';

                     // append caption if exists
                     if bAppend then
                     begin
                        iPos := Pos( '|append' , cHint );
                        if iPos = 0 then
                           iPos := Pos( '| append' , cHint );

                        // hidden-caption
                        //
                        // mobile-v  : in MOBILE PORTRAIT MODE
                        // mobile-h  : in MOBILE LANDSCAPE MODE
                        // mobile    : in MOBILE MODE
                        //
                        if Pos( 'caption-hide:', cHint ) > 0 then
                        begin
                           cTemp3 := ( rc_GetHintProperty( 'caption-hide:', cHint ) );

                           if ( cTemp3 = 'mobile-v' ) and
                              ( mm.varB_Mobile_Screen_Portrait ) then
                              cCaption := ''
                           else
                           if ( cTemp3 = 'mobile-h' ) and
                              ( mm.varB_Mobile_Screen_Landscape ) then
                              cCaption := ''
                           else
                           if ( cTemp3 = 'mobile' ) and
                              ( mm.varB_Mobile_Screen_Portrait ) then
                              cCaption := '';
                        end;

                        TUniControl( TComponent( pForm ).Components[I] ).Caption :=
                            TUniControl( TComponent( pForm ).Components[I] ).Caption +
                            '<span' + varIIF( cClassCaption <> '', ' class="' + Trim( cClassCaption ) + '"', '' ) + '>' + cCaption + '</span>' ;
                     end;
                  end
                  else
                  if cClass <> '' then
                  begin
                       rc_AddCssClass( TComponent( pForm ).Components[I], cClass );
                  end;

                  // bsswt / bschk - Initial ON
                  cTemp := ReturnNumbers( Copy( cHint, Pos( 'bsswt' , cHint.ToLower ) , 7 ) );
                  iPos  := Pos( 'bsswt' , cHint.ToLower );

                  if ( iPos = 0 ) then
                  begin
                     cTemp := ReturnNumbers( Copy( cHint, Pos( 'bschk' , cHint.ToLower ) , 7 ) );
                     iPos  := Pos( 'bschk' , cHint.ToLower );
                  end;

                  if ( iPos > 0 ) and ( cTemp = '1' ) then
                  begin
                         TUniControl( TComponent( pForm ).Components[I] ).Tag := 1;
                  end;
             end;

             cHintDefault := cHint;

             pTypeButton   := '';
             bAppend       := false;
             cClass        := '';
             cClassCaption := '';
             cClassIco     := '';
             cLink         := '';
             cCaption      := '';

             if ( TComponent( pForm ).Components[I] is TUniBitBtn ) or
                ( TComponent( pForm ).Components[I] is TUniSpeedButton ) or
                ( TComponent( pForm ).Components[I] is TUniButton ) then
             begin
                  cTemp2 := '';
                  cTemp3 := '';
                  if Trim( cHint ) <> '' then
                  cTemp2 := cHint + '|';

                  cCmd := cTemp2;

                  iPos2 := Pos( '|' , cTemp2 );

                  if ( iPos2 > 0 ) then
                  begin
                     cTemp  := Trim( Copy( cCmd, 1 , iPos2 ) );
                     cTemp2 := Trim( StringReplace( cCmd, cTemp, '', [rfReplaceAll] ) );

                     cCmd := cTemp2;

                     cTemp  := StringReplace( cTemp, '|', '', [rfReplaceAll] ) + ' ';

                     cTemp := cHint;

                     // append caption if exists
                     if not bAppend then
                        bAppend := rc_PosHintProperty( 'append', cCmd ) > 0;

                     if ( rc_PosHintProperty( 'ico:', cTemp ) > 0 ) and ( rc_PosHintProperty( 'cls-ico:', cTemp ) > 0 ) then
                     begin
                          cClass := '';
                          cClassCaption := '';
                          cIco := rc_GetHintProperty( 'ico:' , cTemp );
                     end;

                     if ( Pos( 'cls:' , cTemp ) > 0 ) then
                     begin
                          cClass := rc_GetHintProperty( 'cls:' , cTemp );

                          cClassCaption := cClass;
                     end;

                     if ( Pos( 'cls-ico:' , cTemp ) > 0 ) then
                     begin
                          cClassIco := rc_GetHintProperty( 'cls-ico:' , cTemp );
                     end;

                     if ( Pos( 'ico:' , cTemp ) > 0 ) then
                     begin
                          cIco := rc_GetHintProperty( 'ico:' , cTemp );
                     end;

                     if ( Pos( 'cls-caption:' , cTemp ) > 0 ) then
                     begin
                          cClassCaption := cClass + ' ' + rc_GetHintProperty( 'cls-caption:' , cTemp );
                     end
                     else
                         cClassCaption := '';

                     //link:
                     if ( rc_PosHintProperty( 'link:', cTemp ) > 0 ) then
                     begin
                          TUniButton( TComponent( pForm ).Components[I] ).OnClick := dm_rc.DynamicOnClickLink;
                     end
                     else
                     if ( rc_PosHintProperty( 'dial:', cTemp ) > 0 ) then
                     begin
                          TUniButton( TComponent( pForm ).Components[I] ).OnClick := dm_rc.DynamicOnClickDial;
                     end
                     else
                     if ( rc_PosHintProperty( 'mail:', cTemp ) > 0 ) then
                     begin
                          TUniButton( TComponent( pForm ).Components[I] ).OnClick := dm_rc.DynamicOnClickMail;
                     end;

                     iPos2 := Pos( '|' , cCmd );
                  end;

                  if trim(cIco) <> '' then
                  begin
                       cTemp := Copy( cHint, Pos( 'ico:' , cHint ) + 4, 100 ) + '|';
                       cTemp := Copy( cTemp, 1, Pos( '|' , cTemp ) - 1 ) ;

                       cTemp := rc_GetHintProperty( 'ico:', cHint ) + '|';

                       cTemp2 := Copy( cTemp, Pos( ' ' , cTemp ) + 1 , 100 ) ;

                       // has a zoom ?
                       iZoom := StrToIntDef( ReturnNumbers( cTemp2 ), 0 );

                       // icon type
                       cTemp3  := Copy( cTemp , 1, Pos( '-' , cTemp ) - 1 ) ;

                       if Copy( cTemp3, 1, 2 ) = 'fa' then
                          cTemp3 := cTemp3 + ' fa-'
                       else
                          cTemp3 := cTemp3 + ' picto-';

                       cTemp2   := TUniControl( TComponent( pForm ).Components[I] ).Caption;

                       TUniControl( TComponent( pForm ).Components[I] ).Caption := '<i class="' ;

                       pTypeButton := Copy( cHint, Pos( 'ico:' , cHint ) + 4, 100 ) + '|';
                       pTypeButton := Copy( pTypeButton, 1, Pos( '|' , pTypeButton ) - 1 );

                       pTypeButton := 'fa-' + Copy( pTypeButton, Pos( ':' , pTypeButton ) + 1 , 100 ) ;

                       pTypeButton := Copy( cTemp, Pos( '-', cTemp ) + 1, 100 ) + '|';
                       pTypeButton := Copy( pTypeButton, 1, Pos( '|', pTypeButton ) - 1 ) ;

                       iPos := rc_PosHintProperty( 'caption:' , cHint );

                       if ( bAppend ) and ( iPos = 0 ) then
                       begin
                          cCaption := cTemp2;
                          TUniControl( TComponent( pForm ).Components[I] ).Hint := rc_SetHintProperty( cCaption, 'caption:' ,  cHint  ) ;
                          cHint := rc_NormalizeHintProperty( TUniControl( TComponent( pForm ).Components[I] ).Hint );
                       end
                       else
                       if iPos > 0 then
                       begin
                          cCaption := rc_GetHintProperty( 'caption:' ,  cHint  );
                       end;

                       // append caption if exists
                       if bAppend then
                       begin
                          TUniControl( TComponent( pForm ).Components[I] ).Caption := TUniControl( TComponent( pForm ).Components[I] ).Caption +
                                cTemp3 + pTypeButton + ' ' + varIIF( iZoom > 0 , 'fa-' + iZoom.ToString + 'x ' , 'fa-1x ' ) + cClassIco + '"></i>';


                          // caption-hide
                          //
                          // mobile-v  : in MOBILE PORTRAIT MODE
                          // mobile-h  : in MOBILE LANDSCAPE MODE
                          // mobile    : in MOBILE MODE
                          //
                          cTemp3 := ( rc_GetHintProperty( 'caption-hide:', cHint ) );

                          if cTemp3 <> '' then
                          begin
                             cTemp3 := ( rc_GetHintProperty( 'caption-hide:', cHint ) );

                             if ( cTemp3 = 'mobile-v' ) and
                                ( mm.varB_Mobile_Screen_Portrait ) then
                                cCaption := ''
                             else
                             if ( cTemp3 = 'mobile-h' ) and
                                ( mm.varB_Mobile_Screen_Landscape ) then
                                cCaption := ''
                             else
                             if ( cTemp3 = 'mobile' ) and
                                ( mm.varB_Mobile_Screen_Portrait ) then
                                cCaption := '';
                          end;

                          if cClassCaption = '' then
                             TUniControl( TComponent( pForm ).Components[I] ).Caption :=
                                 TUniControl( TComponent( pForm ).Components[I] ).Caption +
                                 '<span class="align-btn-caption">'+ cCaption + '</span>'
                          else
                             TUniControl( TComponent( pForm ).Components[I] ).Caption :=
                                 TUniControl( TComponent( pForm ).Components[I] ).Caption +
                                 '<span' + varIIF( cClassCaption <> '', ' class="' + Trim( cClassCaption ) + '"', '' ) + '>'+ cCaption + '</span>' ;
                       end
                       else
                       begin
                          TUniControl( TComponent( pForm ).Components[I] ).Caption := TUniControl( TComponent( pForm ).Components[I] ).Caption +
                                cTemp3 + pTypeButton + ' ' + varIIF( iZoom > 0 , 'fa-' + iZoom.ToString + 'x ' , 'fa-1x ' ) + cClassIco + '"></i>';
                       end;
                  end;

                  pTypeButton := '';

                  if Pos( 'rcbtn_' , cHint ) > 0 then
                     pTypeButton := cHint
                  else
                  if ( Pos( '__' , TUniControl( TComponent( pForm ).Components[I] ).Caption ) > 0 ) then
                    pTypeButton := TUniControl( TComponent( pForm ).Components[I] ).Caption
                  else
                  if ( Pos( 'cls:' , cHint ) > 0 ) then
                  begin
                    pTypeButton := cHintDefault + '|';
                  end;

                  if pTypeButton <> '' then
                  begin
                       if Pos( 'rcbtn_' , cHint ) > 0 then
                          pTypeButton := Copy( cHintDefault, 7, 100 );

                       if ( Pos( '__' , pTypeButton ) > 0 ) then
                       begin
                          TUniControl( TComponent( pForm ).Components[I] ).Caption := Copy( pTypeButton , 1, Pos( '__' , pTypeButton ) - 1 );
                          pTypeButton := Copy( pTypeButton , Pos( '__' , pTypeButton ) + 2, 50 );
                       end
                       else
                       if ( Pos( 'cls:' , pTypeButton ) > 0 ) then
                       begin
                          cTemp := Copy( pTypeButton , Pos( 'cls:' , pTypeButton ) + 4, 100 );
                          pTypeButton := Trim( Copy( cTemp , 1, Pos( '|' , cTemp ) -1 ) );
                       end;

                       TUniControl( TComponent( pForm ).Components[I] ).JSInterface.JSCall( 'removeCls' , [ 'disabled' ]);
                       TUniControl( TComponent( pForm ).Components[I] ).JSInterface.JSCall( 'addCls' , [ pTypeButton ]);

                       if not TUniControl( TComponent( pForm ).Components[I] ).Enabled then
                       begin
                            TUniControl( TComponent( pForm ).Components[I] ).JSInterface.JSCall( 'addCls' , [ 'disabled' ]);
                       end;
                  end;
             end
             else
             if ( TComponent( pForm ).Components[I] is TUniContainerPanel ) or ( TComponent( pForm ).Components[I] is TUniPanel ) then
             begin
                if Pos( 'layout' , lowercase( TUniControl( TComponent( pForm ).Components[I] ).Name ) ) > 0 then
                begin
                      TUniControl( TComponent( pForm ).Components[I] ).Color := StringToColor( pMENU_COLOR );
                end;

                // ajustar ARREDONDAMENTO de panels...
                if   ( Pos( 'searchedit' , lowercase( TComponent( pForm ).Components[I].Name ) ) > 0 ) then
                begin
                      TUniControl( TComponent( pForm ).Components[I] ).JSInterface.JSCall( 'addCls' , ['clsRoundPanel']);
                end;

                cClass := rc_GetHintProperty( 'cls:' , cHint );
                cTemp2 := rc_GetHintProperty( 'round:' , cHint );

                If cTemp2 <> '' then
                begin
                      cTemp := cTemp2;

                      if cTemp2 = 'all' then
                         cTemp2 := ''
                      else
                      if cTemp2 = 't l' then
                         cTemp2 := 'topleft'
                      else
                      if cTemp2 = 't r' then
                         cTemp2 := 'topright'
                      else
                      if cTemp2 = 'l' then
                         cTemp2 := 'topbottomleft'
                      else
                      if cTemp2 = 't' then
                         cTemp2 := 'topleftright'
                      else
                      if cTemp2 = 'r' then
                         cTemp2 := 'topbottomright'
                      else
                      if cTemp2 = 'b l' then
                         cTemp2 := 'bottomleft'
                      else
                      if cTemp2 = 'b r' then
                         cTemp2 := 'bottomright'
                      else
                      if cTemp2 = 'b' then
                         cTemp2 := 'bottomleftright';

                      if cTemp = 'no' then
                         cTemp2 := ''
                      else
                         cTemp2 := 'clsRoundPanel' + cTemp2 ;

                      if cClass <> '' then
                         cClass := ' ' + cClass;
                end;
                if cClass + cTemp2 <> '' then
                   rc_AddCssClass( TComponent( pForm ).Components[I] , cTemp2 + cClass );

                // unicontainerpanel border
                // don´t work well... in development
                cTemp2           := '';
                cTemp3           := '';
                cBorder          := rc_GetHintProperty( 'border:' , cHint );
                cBorderColor     := rc_GetHintProperty( 'border-color:' , cHint );
                cBorderRadius    := rc_GetHintProperty( 'border-radius:' , cHint );

                if cBorderRadius = '' then
                begin
                   cBorderRadius_TL := rc_GetHintProperty( 'border-radius-tl:' , cHint ) + 'px';
                   cBorderRadius_TR := rc_GetHintProperty( 'border-radius-tr:' , cHint ) + 'px';
                   cBorderRadius_BL := rc_GetHintProperty( 'border-radius-bl:' , cHint ) + 'px';
                   cBorderRadius_BR := rc_GetHintProperty( 'border-radius-br:' , cHint ) + 'px';
                end
                else
                begin
                   cBorderRadius_TL := cBorderRadius + 'px';
                   cBorderRadius_TR := cBorderRadius + 'px';
                   cBorderRadius_BL := cBorderRadius + 'px';
                   cBorderRadius_BR := cBorderRadius + 'px';
                end;

                cBorderShadow    := rc_GetHintProperty( 'border-shadow:' , cHint );

                If cBorder <> '' then
                begin
                     if cBorderColor <> '' then
                        cTemp3 := '  this.setStyle("border-color", "' + cBorderColor + '"); '
                     else
                        cTemp3 := '  this.setStyle("border-color", "black"); ' ;

                     if cBorderRadius_TL <> '' then
                        cTemp3 := cTemp3 + '  this.setStyle("border-top-left-radius", "' + cBorderRadius_TL + '"); ' ;
                     if cBorderRadius_TR <> '' then
                        cTemp3 := cTemp3 + '  this.setStyle("border-top-right-radius", "' + cBorderRadius_TR + '"); ' ;
                     if cBorderRadius_BL <> '' then
                        cTemp3 := cTemp3 + '  this.setStyle("border-bottom-left-radius", "' + cBorderRadius_BL + '"); ' ;
                     if cBorderRadius_BR <> '' then
                        cTemp3 := cTemp3 + '  this.setStyle("border-bottom-right-radius", "' + cBorderRadius_BR + '"); ' ;

                     if cBorderShadow <> '' then
                        cTemp3 := cTemp3 + '  this.setStyle("border-shadow", "' + cBorderShadow + '"); ' ;

                     with TUniControl( TComponent( pForm ).Components[I] ).JSInterface do
                     begin
                       JSConfig('border', [ '' + cBorder + '' ]);
                       JSAddListener( 'afterrender',
                                      'function(){ ' +
                                      cTemp3 +
                                      '  this.setStyle("border-style", "solid");' +
                                      '}');
                     end;
                end;
                cTemp2 := '';
                cTemp3 := '';
             end
             else
             if ( TComponent( pForm ).Components[I] is TUniControl ) then
             begin
                cIco := rc_GetHintProperty( 'inputico:' , cHint );

                if cIco <> '' then
                begin
                   // icon type
                   cTemp3  := Copy( cIco , 1, Pos( '-' , cIco ) - 1 ) ;

                   if Copy( cTemp3, 1, 2 ) = 'fa' then
                      cTemp3 := cTemp3 + ' fa-'
                   else
                      cTemp3 := cTemp3 + ' picto-';

                   cIco := cTemp3 + Copy( cIco, Pos( '-', cIco ) +1, 100 );

                   //TUniControl( TComponent( pForm ).Components[I] ).JSInterface.JSCall( 'addCls' , ['inputWithIcon' + varIIF( mm.RTL, '-rtl', '' ) + ' inputIconBg' + varIIF( mm.RTL, '-rtl', '' )]);
                   TUniControl( TComponent( pForm ).Components[I] ).JSInterface.JSCall( 'addCls' , ['inputWithIcon inputIconBg']);

                   if ( TComponent( pForm ).Components[I] is TUniEdit ) then
                   begin
                      TUniEdit( TComponent( pForm ).Components[I] ).RTL                 := mm.RTL;
                      TUniEdit( TComponent( pForm ).Components[I] ).FieldLabel          := varIIF( mm.RTL, '', '<i class="' + cIco + ' fa-lg fa-fw" aria-hidden="true"></i>' );
                      TUniEdit( TComponent( pForm ).Components[I] ).FieldLabelWidth     := 20;
                      TUniEdit( TComponent( pForm ).Components[I] ).FieldLabelSeparator := ' ';
                      TUniEdit( TComponent( pForm ).Components[I] ).FieldLabelAlign     := varIIF( mm.RTL, laRight, laLeft );
                   end
                   else
                   if ( TComponent( pForm ).Components[I] is TUniDBEdit ) then
                   begin
                      TUniDBEdit( TComponent( pForm ).Components[I] ).RTL                 := mm.RTL;
                      TUniDBEdit( TComponent( pForm ).Components[I] ).FieldLabel          := varIIF( mm.RTL, '', '<i class="' + cIco + ' fa-lg fa-fw" aria-hidden="true"></i>' );
                      TUniDBEdit( TComponent( pForm ).Components[I] ).FieldLabelWidth     := 20;
                      TUniDBEdit( TComponent( pForm ).Components[I] ).FieldLabelSeparator := ' ';
                      TUniDBEdit( TComponent( pForm ).Components[I] ).FieldLabelAlign     := varIIF( mm.RTL, laRight, laLeft );
                   end
                   else
                   if ( TComponent( pForm ).Components[I] is TUniNumberEdit ) then
                   begin
                      TUniNumberEdit( TComponent( pForm ).Components[I] ).RTL                 := mm.RTL;
                      TUniNumberEdit( TComponent( pForm ).Components[I] ).FieldLabel          := varIIF( mm.RTL, '', '<i class="' + cIco + ' fa-lg fa-fw" aria-hidden="true"></i>' );
                      TUniNumberEdit( TComponent( pForm ).Components[I] ).FieldLabelWidth     := 20;
                      TUniNumberEdit( TComponent( pForm ).Components[I] ).FieldLabelSeparator := ' ';
                      TUniNumberEdit( TComponent( pForm ).Components[I] ).FieldLabelAlign     := varIIF( mm.RTL, laRight, laLeft );
                   end
                   else
                   if ( TComponent( pForm ).Components[I] is TUniDBNumberEdit ) then
                   begin
                      TUniDBNumberEdit( TComponent( pForm ).Components[I] ).RTL                 := mm.RTL;
                      TUniDBNumberEdit( TComponent( pForm ).Components[I] ).FieldLabel          := varIIF( mm.RTL, '', '<i class="' + cIco + ' fa-lg fa-fw" aria-hidden="true"></i>' );
                      TUniDBNumberEdit( TComponent( pForm ).Components[I] ).FieldLabelWidth     := 20;
                      TUniDBNumberEdit( TComponent( pForm ).Components[I] ).FieldLabelSeparator := ' ';
                      TUniDBNumberEdit( TComponent( pForm ).Components[I] ).FieldLabelAlign     := varIIF( mm.RTL, laRight, laLeft );
                   end ;
                end;
             end;
           end;
        end;
     except on e:exception do
            begin
                 //UniSession.ResumeLayouts();
                 cTemp := '';
                 if pControl <> nil then
                    cTemp := pControl.Name;

                 ShowMessage( 'rc_RenderControlsExecute' + sLineBreak + sLineBreak +
                              'I=' + i.ToString + sLineBreak + sLineBreak +
                              'Obj:' + cTemp + sLineBreak + sLineBreak +
                              e.Message );
            end;
     end;
     //UniSession.ResumeLayouts();
end;
// v. 3.2.0.6
procedure rc_BootStrapRenderExecute( pForm : TObject ; pUpdateDBFields : Boolean ; pTabIni, pTabEnd : integer; pMobileScreen, pLandScape : boolean ; pOnlyThisObj : TObject );
var
  oObj : TObject;
  oObjTemp : TUniControl;

  pQryMaster : TFDQuery;
  pDsMaster  : TDataSource;

  cHint, cHintDefault,
  cCaption,
  cField,
  cValue,
  cSeq,
  cTemp,
  cTemp2,
  cTemp3,
  cTemp4,
  cDataSource,
  cQuery,

  cActive,

  cCloseBtn,
  cBsTempVal,
  cBsComponent,
  cBsCaption,
  cBsTemp,
  cBsField,
  cBsClass,
  cBsColor,
  cBsType : string;

  bEnabled,
  bisDB : Boolean;

  iW, iH,
  iReduc,
  iBsTempVal,
  iPos, iPosIni, iPosEnd,
  I, F : Integer;

  pPageControl : TUnipagecontrol;

  varSL_TagParams,
  varSL_HtmlMenu,
  varSL_HtmlPage : TStringList;
begin
     //UniSession.SuspendLayouts();
     oObj       := nil;
     oObjTemp   := nil;
     pQryMaster := nil;
     iW         := 0;
     varSL_HtmlPage := TStringList.Create;

     if TComponent( pForm ) <> nil then
     begin
         for I := 0 to TComponent( pForm ).ComponentCount - 1 do
         begin
             Try
                 if pOnlyThisObj = nil then
                    oObj := TComponent( pForm ).Components[I]
                 else
                    oObj := pOnlyThisObj;

                 cHint    := '';

                 If ( Pos( 'TAction' , TComponent( pForm ).Components[I].ClassName ) > 0 ) then
                    cTemp := cTemp;

                 If ( Pos( 'TAction' , TComponent( pForm ).Components[I].ClassName ) = 0 ) then
                 begin
                    // Ext.ToolTip
                    If GetPropInfo( oObj.ClassInfo, 'Hint') <> nil then
                    begin
                       // refazer Hint do bsAlert ( feedback by daniel rodrigues )
                       if ( oObj is TUniLabel ) then
                       begin
                          cCaption := TUniControl( oObj ).Caption;
                          if Copy( cCaption, 1, 26 ) = '<div  class ="alert alert-'  then
                          begin
                               cTemp := Trim( Copy( cCaption, 27, Pos( ' alert-dismissible', cCaption ) - 1 ) );
                               cTemp := Copy( cTemp, 1, Pos( ' ' , cTemp ) - 1 );
                               TUniControl( oObj ).Hint :=
                                  '[[ bsAlert:' + cTemp + ' ]]';

                               cCaption := Copy( cCaption , Pos( '</h5>', cCaption ) + 5, 500 );
                               cCaption := Copy( cCaption , 1, Pos( '</div>', cCaption ) - 1 );
                               TUniControl( oObj ).Caption := cCaption;
                          end;

                          cCaption := '';
                       end;

                       cHint    := TUniControl( oObj ).Hint;

                       if Pos( '[[', cHint ) = 0 then
                          cHint := ''
                       else
                       begin
                          cHint := StringReplace( cHint , '[[' , '', [rfReplaceAll] );
                          cHint := StringReplace( cHint , ']]' , '', [rfReplaceAll] ) + ' ';
                       end;

                       if ( Pos( '[[', cHint ) > 0 ) and ( Pos( #$D , cHint ) > 0 )then
                       begin
                          TUniControl( oObj ).hint := StringReplace( TUniControl( oObj ).hint, #$D, '', [rfreplaceall] );
                          cHint    := TUniControl( oObj ).Hint;
                       end;
                    end;

                    cHintDefault := cHint;
                    cHintDefault := trim( rc_NormalizeHintProperty( cHintDefault )) + ' ';
                    cHint        := trim( rc_NormalizeHintProperty( cHint )) + ' ';

                    // if not HINT 'attribute' defined( [[ )....
                    if ( cHint <> '' ) or ( Pos( 'bsrgp' , lowercase( TUniControl( oObj ).Name ) ) > 0 ) then
                    begin
                        // bsToolTip
                        if Pos( ' hint:' , cHint ) > 0 then
                        begin
                           //( feedback by JOAS )
                           cTemp    := Trim(Copy( cHintDefault, Pos( 'hint:' , cHintDefault ) + 5 , 200 ))  ;
                           if Pos( '|', cTemp ) > 0 then
                              cTemp    := Trim(Copy( cTemp, 1, Pos( '|' , cTemp ) -1 ))
                           else
                           if Pos( ']]', cTemp ) > 0 then
                              cTemp    := Trim(Copy( cTemp, 1, Pos( ']]' , cTemp ) -1 )) ;

                           TUniControl( oObj ).ClientEvents.ExtEvents.Values['afterrender'] :=
                              'function afterrender(sender, eOpts){'+
                                 'Ext.create(''Ext.tip.ToolTip'','+
                                 '{  target: sender.getEl(), ' +
                                 '   html: "' + cTemp + '"})}' ;
                        end;

                        if ( oObj is TUniLabel ) then
                        begin
                           cCaption := TUniControl( oObj ).Caption;

                           cTemp    := trim( Copy( cHint, Pos( 'bsh' , lowercase(cHint) ) , 100 ) );
                           cTemp    := Copy( cTemp, 1, Pos( ':' , cTemp ) - 1 );

                           cTemp2   := lowercase( TUniControl( oObj ).Name );
                           cTemp2   := Copy( cTemp2, 1, 5 );

                           if ( Pos( cTemp, BS_COMPONENTS ) > 0 ) or ( Pos( cTemp2, BS_COMPONENTS ) > 0 ) then
                           begin
                              // remover o SUBLINHADO
                              if ( oObj is TUniLabel ) then
                              begin
                                TUniLabel( oObj ).Font.Style := [];
                              end;

                              cTemp := '';
                              for f := 1 to 6 do
                                  if ( Copy( cHint, 1, 5 ) = 'bsh' + f.ToString + ':' ) then
                                  begin
                                      cHint := StringReplace( cHint, 'bsh' + f.ToString + ':', '', [rfReplaceAll] );

                                      if pos( 'cls:' , cHint ) > 0 then
                                      begin
                                         cHint := Copy( cHint, Pos( 'cls:', cHint ) + 4, 100 );
                                         cHint := Copy( cHint, 1, Pos( ' ', cHint ) - 1 );
                                      end;

                                      TUniLabel( oObj ).TextConversion := txtHTML;

                                      cTemp := TUniControl( oObj ).Caption ;
                                      TUniControl( oObj ).Caption := '';
                                      TUniControl( oObj ).Caption := '<h' + f.ToString + '>' + cTemp + '</h' + f.ToString + '>';

                                      // align label
                                      if cHint <> '' then
                                      begin
                                         // v. 3.2.0.0
                                         //rc_AlignLabel( TUniLabel( oObj ), cHint );
                                         if mm.RTL then
                                             rc_AddCssClass( TUniLabel( oObj ), 'align-label-right-center' )
                                         else
                                             rc_AddCssClass( TUniLabel( oObj ), 'align-label-left-center' );
                                      end;
                                      Break;
                                  end;

//                              cTemp4 := rc_GetHintProperty( 'rcalert:', cHint, false ) ;
                              //if cTemp4 <> '' then
                              if Pos( 'rcalert:' , cHint ) > 0 then
                              begin
                                  cTemp4 := rc_GetHintProperty( 'rcalert:', cHint, false ) ;
                                  TUniLabel( oObj ).TextConversion := txtHTML;

                                  cTemp4 := cTemp4 + ' ';
                                  cCaption := rc_GetHintProperty( 'title:', cTemp4, true, true );
                                  cTemp4   := Copy( cTemp4, 1, Pos( ' ', cTemp4 ) - 1 );
                                  //cTemp4   := stringReplace( cTemp4, cCaption, '', [rfReplaceAll] );

                                  cTemp := cTemp4;//Trim( StringReplace( cTemp4 , 'rcalert:' , '', [rfReplaceAll] ) );
                                  cTemp4 := cCaption;
                                  cCaption := cTemp;
                                  cTemp3   := mm.MSG_INFO;

                                  if cTemp = 'danger' then
                                  begin
                                     cCaption := 'ban';
                                     cTemp3   := mm.MSG_DANGER;
                                  end
                                  else
                                  if cTemp = 'warning' then
                                  begin
                                     cCaption := 'exclamation-triangle';
                                     cTemp3   := mm.MSG_WARNING;
                                  end
                                  else
                                  if cTemp = 'success' then
                                  begin
                                     cCaption := 'check';
                                     cTemp3   := mm.MSG_SUCCESS;
                                  end;

                                  if Pos( '-',cCaption )=0 then
                                     cCaption := 'fa-' + cCaption
                                  else
                                     cTemp := 'themed';

                                  cTemp2 :=
                                     ' <div class="rc-' + cTemp + '-alert rc-label-wrap">' +
                                     '   <i class="fas ' + cCaption + '"></i>' +
                                     '   <div class="rc-' + cTemp + '-alert-content">' +
                                     '     <div class="rc-' + cTemp + '-alert-title">' + cTemp4 + '</div>' +
                                     '     <div>' + TUniLabel( oObj ).Caption + '</div>' +
                                     '   </div>' +
                                     ' </div>';

                                  TUniControl( oObj ).Caption := cTemp2 ;
                                  TUniControl( oObj ).Hint    := '';
                              end
                              else
                              if Pos( 'rcfeature:' , cHint ) > 0 then
                              begin
                                  cTemp4 := rc_GetHintProperty( 'rcfeature:', cHint, false ) ;
                                  TUniLabel( oObj ).TextConversion := txtHTML;

                                  cTemp4 := cTemp4 + ' ';
                                  cCaption := rc_GetHintProperty( 'title:', cTemp4, true, true );
                                  cTemp4   := Copy( cTemp4, 1, Pos( ' ', cTemp4 ) - 1 );
                                  //cTemp4   := stringReplace( cTemp4, cCaption, '', [rfReplaceAll] );

                                  cTemp := cTemp4;//Trim( StringReplace( cTemp4 , 'rcalert:' , '', [rfReplaceAll] ) );
                                  cTemp4 := cCaption;
                                  cCaption := cTemp;
                                  cTemp3   := mm.MSG_INFO;

//                                  if cTemp = 'danger' then
//                                  begin
//                                     cCaption := 'ban';
//                                     cTemp3   := mm.MSG_DANGER;
//                                  end
//                                  else
//                                  if cTemp = 'warning' then
//                                  begin
//                                     cCaption := 'exclamation-triangle';
//                                     cTemp3   := mm.MSG_WARNING;
//                                  end
//                                  else
//                                  if cTemp = 'success' then
//                                  begin
//                                     cCaption := 'check';
//                                     cTemp3   := mm.MSG_SUCCESS;
//                                  end;

                                  cTemp2 :=
                                     '<div class="feature-tiles">' +
                                     '  <div class="feature">' +
                                     '    <div class="icon">' +
                                     '      <i class="fas ' + cCaption + '"></i>' +
                                     '    </div>' +
                                     '    <div class="description">' +
                                     '      <h3>' + cTemp4 + '</h3>' +
                                     '      <p>' + TUniLabel( oObj ).Caption + '</p>' +
                                     '    </div>' +
                                     '  </div>' +
                                     '</div>' ;
//                                     ' <div class="rc-' + cTemp + '-alert rc-label-wrap">' +
//                                     '   <i class="fa fa-' + cCaption + '"></i>' +
//                                     '   <div class="rc-' + cTemp + '-alert-content">' +
//                                     '     <div class="rc-' + cTemp + '-alert-title">' + cTemp4 + '</div>' +
//                                     '     <div>' + TUniLabel( oObj ).Caption + '</div>' +
//                                     '   </div>' +
//                                     ' </div>' ;

                                  TUniControl( oObj ).Caption := cTemp2 ;
                                  TUniControl( oObj ).Hint    := '';
                              end
                              else
                              if Pos( 'bsalert:' , cHint ) > 0 then
                              begin
                                  TUniLabel( oObj ).TextConversion := txtHTML;
                                  cTemp := Trim( StringReplace( cHint , 'bsalert:' , '', [rfReplaceAll] ) );

                                  cCaption := cTemp;
                                  cTemp3   := mm.MSG_INFO;

                                  if cTemp = 'danger' then
                                  begin
                                     cCaption := 'ban';
                                     cTemp3   := mm.MSG_DANGER;
                                  end
                                  else
                                  if cTemp = 'warning' then
                                  begin
                                     cCaption := 'exclamation-triangle';
                                     cTemp3   := mm.MSG_WARNING;
                                  end
                                  else
                                  if cTemp = 'success' then
                                  begin
                                     cCaption := 'check';
                                     cTemp3   := mm.MSG_SUCCESS;
                                  end;

                                  cTemp2 := '<div class="alert alert-' + cTemp + ' alert-dismissible rc-label-wrap">' +
                                            '<h5><i class="icon fas fa-' + cCaption + '"></i> '+ cTemp3 + '</h5>' +
                                            TUniLabel( oObj ).Caption +
                                            '</div>';

                                  TUniControl( oObj ).Caption := cTemp2 ;
                                  TUniControl( oObj ).Hint    := '';
                              end
                              else
                              if ( Pos( 'bslabel:' , cHint ) > 0 ) and ( Pos( '<i class' , cCaption ) = 0 ) then
                              begin
                                  TUniLabel( oObj ).TextConversion := txtHTML;
                                  cTemp := StringReplace( cHint , 'bslabel:' , '', [rfReplaceAll] );

                                  iPos := Pos( 'fa-' , cTemp );
                                  if iPos > 0 then
                                     cTemp := '<i class="fas fa-camera "></i> ' + cCaption;

                                  TUniControl( oObj ).Caption := cTemp ;
                              end
                              else
                              if Pos( 'bsbtn:' , cHint ) > 0 then
                              begin
                                   TUniLabel( oObj ).TextConversion := txtHTML;
                                   cBsTemp := Copy( cHint, Pos( ':' , cHint ) + 1 , 100 );

                                   cBsCaption := '';
                                   if Pos( 'caption:' , cBsTemp ) > 0 then
                                   begin
                                      cBsTemp := Copy( cBsTemp, 1, Pos( 'caption:' , cBsTemp ) - 1 );
                                      cBsCaption := Trim( Copy( cHintDefault, Pos( 'caption:' , cHintDefault ) + 8 , 100 ) );
                                   end;

                                   TUniControl( oObj ).Caption := '<button type="submit" class="btn btn-' + cBsTemp + '">' + cBsCaption + '</button>';
                              end
                              else
                              if Pos( 'bsedit:' , cHint ) > 0 then
                              begin
                                  cTemp := Copy( cHint, Pos( 'bsedit:' , cHint ) + 9, 100 ) ;
                                  cTemp := Trim( Copy( cTemp, 1, Pos( ' ' , cTemp ) -1 ) );

                                  cBsTemp := '';
                                  if Pos( 'texthint:' , cHint ) > 0 then
                                  begin
                                     cBsCaption := Copy( cHintDefault, Pos( 'texthint:' , cHintDefault ) + 9, 100 );
                                  end;

                                  TUniLabel( oObj ).TextConversion := txtHTML;
                                  TUniControl( oObj ).Caption := '<input type="text" class="form-control" placeholder="' + cBsCaption + '">';
                              end
                              else
                              if Pos( 'bsemail: ' , cHint ) > 0 then
                              begin
                                  //[[bsEmail: icon:envelope texthint:Usuário]]
                                  TUniLabel( oObj ).TextConversion := txtHTML;

                                  cTemp := Copy( cHint, Pos( 'bsemail:' , cHint ) + 9, 100 ) ;
                                  cTemp := Trim( Copy( cTemp, 1, Pos( ' ' , cTemp ) -1 ) );

                                  cBsTemp := '';
                                  if Pos( 'texthint:' , cHint ) > 0 then
                                  begin
                                     cBsCaption := Copy( cHintDefault, Pos( 'texthint:' , cHintDefault ) + 9, 100 );
                                  end;

                                  if Pos( 'icon:' , cHint ) > 0 then
                                  begin
                                     cBsTemp := Copy( cHint, Pos( 'icon:' , cHint ) + 5 , 100 );
                                     cBsTemp := Copy( cBsTemp, 1, Pos( ' ' , cBsTemp ) - 1 );

                                     TUniControl( oObj ).Caption := '<div class="input-group mb-3"><div class="input-group-prepend"><span class="input-group-text"><i class="fas fa-' + cBsTemp + '"></i></span></div><input type="email" class="form-control" placeholder="' + cBsCaption + '"></div>';
                                  end
                                  else
                                     TUniControl( oObj ).Caption := '<input type="email" class="form-control" placeholder="' + cBsCaption + '">';
                              end
                              else
                              if Pos( 'bspassword:' , cHint ) > 0 then
                              begin
                                  cTemp := Copy( cHint, Pos( 'bspassword:' , cHint ) + 9, 100 ) ;
                                  cTemp := Trim( Copy( cTemp, 1, Pos( ' ' , cTemp ) -1 ) );

                                  cBsTemp := '';
                                  if Pos( 'texthint:' , cHint ) > 0 then
                                  begin
                                     cBsCaption := Copy( cHintDefault, Pos( 'texthint:' , cHintDefault ) + 9, 100 );
                                  end;

                                  if Pos( 'icon:' , cHint ) > 0 then
                                  begin
                                     cBsTemp := Copy( cHint, Pos( 'icon:' , cHint ) + 5 , 100 );
                                     cBsTemp := Copy( cBsTemp, 1, Pos( ' ' , cBsTemp ) - 1 );

                                     TUniControl( oObj ).Caption := '<div class="input-group mb-3"><div class="input-group-prepend"><span class="input-group-text"><i class="fas fa-' + cBsTemp + '"></i></span></div><input type="password" class="form-control" placeholder="' + cBsCaption + '"></div>';
                                  end
                                  else
                                     TUniControl( oObj ).Caption := '<input type="password" class="form-control" placeholder="' + cBsCaption + '">';
                              end
                              else
                              if Pos( 'bsmemo:' , cHint ) > 0 then
                              begin
                                  iBsTempVal := 3;
                                  TUniLabel( oObj ).TextConversion := txtHTML;

                                  if Pos( 'rows:' , cHint ) = 0 then
                                  begin
                                     cBsTemp := Copy( cHint, Pos( 'rows:' , cHint ) + 5 , 100 );
                                     cBsTemp := Copy( cBsTemp, 1, Pos( ' ' , cBsTemp ) - 1 );
                                     iBsTempVal := StrToIntDef( cBsTemp , 3 );
                                  end;

                                  TUniControl( oObj ).Caption := '<textarea class="form-control" rows="' + iBsTempVal.ToString + '"></textarea>';
                              end
                              else
                              if Pos( 'bsdate:' , cHint ) > 0 then
                              begin
                                  TUniLabel( oObj ).TextConversion := txtHTML;
                                  cBsTemp := Copy( cHint, Pos( '_' , cHint ) + 1 , 100 );
                                  cBsTemp := Copy( cBsTemp, 1, Pos( '__' , cBsTemp ) - 1 );
                                  iBsTempVal := StrToIntDef( cBsTemp , 0 );
                                  cBsCaption := Trim(Copy( cHint, Pos( '__' , cHint ) + 2 , 100 ) );

                                  TUniControl( oObj ).Caption :=
                                  '<div class="input-group"><div class="input-group-prepend"><span class="input-group-text"><i class="fa fa-calendar"></i></span></div><input type="text" class="form-control" data-inputmask="''alias'': ''dd/mm/yyyy''" data-mask="" im-insert="true"></div>';
                              end
                              else
                              if ( Pos( 'bschk:' , cHint ) > 0 ) or ( Pos( 'bsswt:' , cHint ) > 0 ) then
                              begin
                                  TUniLabel( oObj ).TextConversion := txtHTML;
                                  if Pos( 'bschk:' , cHint ) > 0 then
                                     cBsComponent := 'bschk'
                                  else
                                     cBsComponent := 'bsswt';

                                  cTemp2 := cHint;

                                  if Pos( 'reportmenuclientes' , lowercase( TUniControl( oObj ).Name ) ) > 0 then
                                     cTemp2 := cTemp2;

                                  // red or green( only switch )
                                  if ( Pos( '*' , cTemp2 ) > 0 ) and ( cBsComponent = 'bsswt' ) then
                                  begin
                                     cTemp := 'custom-switch-off-danger custom-switch-on-success';
                                     cHint := StringReplace( cTemp2, '*', '',[rfReplaceAll] );
                                  end
                                  else
                                     cTemp := '';

                                  cTemp2 := cHint;

                                  // field ?
                                  if Pos( 'field:' , cTemp2 ) > 0 then
                                  begin
                                     cBsField := Copy( cTemp2, Pos( 'field:' , cTemp2 ) , 100 );
                                     cHint := StringReplace( cTemp2, cBsField, '',[rfReplaceAll] );
                                     cBsField := Trim( Copy( cBsField, 7 , 100 ) ) + ' ';
                                     cBsField := Copy( cBsField, 1, Pos( ' ' , cBsField ) -1 );
                                  end
                                  else
                                     cBsField := '';

                                  bisDB    := ( cBsField <> '' );

                                  cTemp2 := cHint;

                                  cBsTemp := Copy( cTemp2, Pos( '_' , lowercase( cTemp2 ) ) + 1 , 100 );
                                  cBsCaption := '';
                                  iBsTempVal := TUniControl( oObj ).Tag;
                                  bEnabled   := TUniControl( oObj ).Enabled;

                                  cDataSource := '';
                                  pDsMaster   := nil;
                                  cQuery      := '';

                                  if bisDB then
                                  begin
                                     if Pos( 'ds:', TUniControl( oObj ).hint ) > 0 then
                                     begin
                                        cDataSource := Trim( Copy( TUniControl( oObj ).hint, Pos( 'ds:', TUniControl( oObj ).hint ) + 3, 100 ) );
                                        cDataSource := Trim( StringReplace( cDataSource , ']]', '', [rfReplaceAll] ) ) + ' ';
                                        cDataSource := Copy( cDataSource, 1, Pos( ' ' , cDataSource ) -1 );
                                        pDsMaster   := TDataSource( TComponent( TComponent( pForm ) ).FindComponent( cDataSource ) );
                                     end
                                     else
                                        pDsMaster   := TDataSource( TComponent( TComponent( pForm ) ).FindComponent( 'dsmaster' ) );
                                  end;

                                  if pDsMaster <> nil then
                                  begin
                                     pQryMaster := TFdQuery( pDsMaster.DataSet );
                                     cQuery     := pQryMaster.Name;
                                  end;

                                  // read and update?
                                  if ( pUpdateDBFields ) and ( bisDB ) then
                                  begin
                                     if pQryMaster <> nil then
                                        if ( pQryMaster.State <> dsInactive ) then
                                        begin
                                             cTemp  := TUniControl( oObj ).Caption ;

                                             iPosIni := Pos( 'field=' , cTemp ) + 6;
                                             iPosEnd := Pos( 'form='  , cTemp ) - 1;

                                             cBsField   := Copy( cTemp, iPosIni, iPosEnd ) ;
                                             cBsField   := Trim( Copy( cBsField, 1, Pos ( ',', cBsField ) - 3 ) ) ;

                                             if cBsField <> '' then
                                             begin
                                                try
                                                   if DataTypeIsNumber( pQryMaster.FieldByName( cBsField ).DataType ) then
                                                      iBsTempVal := varIIF( pQryMaster.FieldByName( cBsField ).IsNull, 0, pQryMaster.FieldByName( cBsField ).Value )
                                                   else
                                                      iBsTempVal := varIIF( ( pQryMaster.FieldByName( cBsField ).Value = mm.VALUE_YES ) , 1, 0 );
                                                except on e:exception do
                                                       begin
                                                            dm_rc.rc_ShowError( cBsField + ' ' + e.Message )
                                                       end;
                                                end;

                                                iPosIni := Pos( 'type="checkbox"' , cTemp );
                                                iPosEnd := Pos( 'class="custom-control-input"' , cTemp );

                                                cTemp2 := Copy( cTemp, iPosIni, iPosEnd ) ;

                                                TUniControl( oObj ).Tag := iBsTempVal;

                                                cTemp := StringReplace( cTemp, 'checked=""', '',[rfReplaceAll] );
                                                cTemp := StringReplace( cTemp, 'disabled=""', '',[rfReplaceAll] );

                                                TUniControl( oObj ).Caption :=
                                                   Copy( cTemp, 1, iPosIni + 16 ) + varIIF( iBsTempVal = 1, 'checked=""', '' ) +
                                                   varIIF( ( pQryMaster.State in [dsInsert, dsEdit ] ) and ( bEnabled ) , '', 'disabled=""' ) +
                                                   Trim( Copy( cTemp, iPosIni + 16, 500 ) );
                                             end;

                                        end;
                                  end
                                  else
                                  begin
                                     if cBsComponent = 'bschk' then
                                        TUniControl( oObj ).Caption :=
                                          '<div class="custom-control custom-checkbox"><input type="checkbox" ' +
                                             varIIF( iBsTempVal = 1, 'checked=""', '' ) +
                                             varIIF( bEnabled, '', 'disabled=""' ) +
                                             ' class="custom-control-input" ' +
                                             'onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                QuotedStr( cBsComponent + '=' + iBsTempVal.ToString ) + ', ' +
                                                QuotedStr( 'chk=' + TUniControl( oObj ).Name ) + ' , ' +
                                                QuotedStr( 'field=' + cBsField ) + ' , ' +
                                                QuotedStr( 'query=' + cQuery ) + ' , ' +
                                                QuotedStr( 'form=' + TComponent( pForm ).Name ) + '] );" id="bschk_' +
                                                   TUniControl( oObj ).Name + '"><label class="custom-control-label" for="bschk_' +
                                                   TUniControl( oObj ).Name +'">' + cBsCaption + '</label></div>'
                                     else
                                        TUniControl( oObj ).Caption :=

                                          '<div class="custom-control custom-switch ' + cTemp + '"><input type="checkbox" ' +
                                             varIIF( iBsTempVal = 1, 'checked=""', '' ) +
                                             varIIF( bEnabled, '', 'disabled=""' ) +
                                             ' class="custom-control-input" ' +
                                             'onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                QuotedStr( cBsComponent + '=' + iBsTempVal.ToString ) + ', ' +
                                                QuotedStr( 'swt=' + TUniControl( oObj ).Name ) + ' , ' +
                                                QuotedStr( 'field=' + cBsField ) + ' , ' +
                                                QuotedStr( 'query=' + cQuery ) + ' , ' +
                                                QuotedStr( 'form=' + TComponent( pForm ).Name ) + '] );" id="bsswt_' +
                                                   TUniControl( oObj ).Name + '"><label class="custom-control-label" for="bsswt_' +
                                                   TUniControl( oObj ).Name +'">' + cBsCaption + '</label></div>';
                                  end;
                              end
                              else
                              if ( Pos( 'bsrgp' , lowercase( TUniControl( oObj ).Name ) ) > 0 ) then
                              begin
                                     TUniLabel( oObj ).TextConversion := txtHTML;
                                     cBsComponent := 'bsrgp';

                                     //bsrgpTipo01_M     bsrgpTipo_do_feriado01_M_db
                                     cHint    := TUniControl( oObj ).Name;

                                     if Pos( 'bsrgpTipo', TUniLabel( oObj ).Name ) > 0 then
                                        cTemp2 := cTemp2;

                                     cTemp2   := cHint;
                                     cTemp3   := ReverseStr( cTemp2 );

                                     // field ?   //M_10opiTpgRsb   bd_M_10odairef_od_opiTpgRsb
                                     bisDB    := ( Pos( 'bd_', cTemp3 ) > 0 );

                                     cSeq     := dm_rc.rc_GetParamFromRGP( cHint, rptSEQ );
                                     cField   := dm_rc.rc_GetParamFromRGP( cHint, rptFIELD );
                                     cValue   := dm_rc.rc_GetParamFromRGP( cHint, rptVALUE );
                                     cBsField := cField;
                                     cBsTemp  := cValue;
                                     cBsCaption := '';
                                     cBsTempVal := cBsTemp;

                                     iPos       := StrToIntDef( cSeq, 0 );

                                     iBsTempVal := TUniControl( oObj ).Tag;

                                     cTemp  := TUniControl( oObj ).Caption ;

                                     cDataSource := '';
                                     pQryMaster := nil;
                                     cQuery     := '';

                                     If ( bisDB ) then
                                     begin
                                        if Pos( 'ds:', TUniControl( oObj ).hint ) > 0 then
                                        begin
                                           cDataSource := Trim( Copy( TUniControl( oObj ).hint, Pos( 'ds:', TUniControl( oObj ).hint ) + 3, 100 ) );
                                           cDataSource := Trim( StringReplace( cDataSource , ']]', '', [rfReplaceAll] ) ) + ' ';
                                           cDataSource := Copy( cDataSource, 1, Pos( ' ' , cDataSource ) -1 );
                                           pDsMaster   := TDataSource( TComponent( TComponent( pForm ) ).FindComponent( cDataSource ) );
                                        end
                                        else
                                           pDsMaster   := TDataSource( TComponent( TComponent( pForm ) ).FindComponent( 'dsmaster' ) );

                                        pQryMaster := nil;
                                        cQuery     := '';
                                        if pDsMaster <> nil then
                                        begin
                                           pQryMaster := TFdQuery( pDsMaster.DataSet );
                                           cQuery     := pQryMaster.Name;
                                        end;
                                     end;

                                     // read and update?
                                     if ( pUpdateDBFields ) and ( bisDB ) then
                                     begin
                                        cTemp  := TUniControl( oObj ).Caption ;

                                        if pQryMaster <> nil then
                                        begin
                                           if ( pQryMaster.State <> dsInactive ) then
                                           begin
                                                cTemp  := TUniControl( oObj ).Caption ;

                                                iPosIni := Pos( 'field=' , cTemp ) + 6;
                                                iPosEnd := Pos( 'form='  , cTemp ) - 1;

                                                cBsField   := Copy( cTemp, iPosIni, iPosEnd ) ;
                                                cBsField   := Trim( Copy( cBsField, 1, Pos ( ',', cBsField ) - 3 ) ) ;

                                                if cBsField <> '' then
                                                begin
                                                   // field content
                                                   try
                                                       if DataTypeIsNumber( pQryMaster.FieldByName( cBsField ).DataType ) then
                                                          cBsTempVal := varIIF( pQryMaster.FieldByName( cBsField ).IsNull, -1, pQryMaster.FieldByName( cBsField ).Value )
                                                       else
                                                          cBsTempVal := varIIF( pQryMaster.FieldByName( cBsField ).IsNull, '', pQryMaster.FieldByName( cBsField ).Value );
                                                   except on e:exception do
                                                          begin
                                                               dm_rc.rc_ShowError( cBsField + ' ' + e.Message )
                                                          end;
                                                   end;

                                                   iPosIni := Pos( 'type="radio"' , cTemp );
                                                   iPosEnd := Pos( 'onclick="ajaxRequest' , cTemp );

                                                   cTemp2 := Copy( cTemp, iPosIni, iPosEnd ) ;

                                                   // rc_RgpCheck / rc_RgpInitialize
                                                   if ( iBsTempVal = 999 ) or ( iBsTempVal = -999 ) then
                                                   begin
                                                      if iBsTempVal = 999 then
                                                      begin
                                                         iBsTempVal := 1;

                                                         if pQryMaster.State in [dsInsert, dsEdit ] then
                                                            pQryMaster.FieldByName( cBsField ).Value := cBsTemp;

                                                      end
                                                      else
                                                      if iBsTempVal = -999 then
                                                      begin
                                                         iBsTempVal := 0;

                                                         if pQryMaster.State in [dsInsert, dsEdit ] then
                                                            pQryMaster.FieldByName( cBsField ).Clear;
                                                      end;
                                                   end
                                                   else
                                                   if iBsTempVal <> -1 then
                                                      iBsTempVal := varIIF( cBsTempVal = cBsTemp , 1, 0 )
                                                   else
                                                      iBsTempVal := 0;

                                                   cTemp := StringReplace( cTemp, ' checked="" ', '',[rfReplaceAll] );
                                                   cTemp := StringReplace( cTemp, ' disabled="" ', '',[rfReplaceAll] );

                                                   if iBsTempVal = -1 then
                                                      TUniControl( oObj ).Caption :=
                                                         Copy( cTemp, 1, iPosIni + 12 ) + '' +
                                                         varIIF( pQryMaster.State in [dsInsert, dsEdit ] , '', ' disabled="" ' ) +
                                                         Trim( Copy( cTemp, iPosIni + 12, 500 ) )
                                                   else
                                                      TUniControl( oObj ).Caption :=
                                                         Copy( cTemp, 1, iPosIni + 12 ) + varIIF( iBsTempVal = 1, ' checked="" ', '' ) +
                                                         varIIF( pQryMaster.State in [dsInsert, dsEdit ] , '', ' disabled="" ' ) +
                                                         Trim( Copy( cTemp, iPosIni + 12, 500 ) );

                                                   cTemp := cTemp ;
                                                end;
                                           end;
                                        end;
                                     end
                                     else
                                     begin
                                           // rc_RgpCheck / rc_RgpInitialize
                                           if ( iBsTempVal = 999 ) or ( iBsTempVal = -999 ) then
                                           begin
                                              if iBsTempVal = 999 then
                                              begin
                                                 iBsTempVal := 1;
                                              end
                                              else
                                              if iBsTempVal = -999 then
                                              begin
                                                 iBsTempVal := 0;
                                              end;
                                           end
                                           else
                                           if iBsTempVal = -1 then
                                              iBsTempVal := 0;

                                           TUniControl( oObj ).Caption :=
                                             '<div class="custom-control custom-radio"><input class="custom-control-input" type="radio" ' + varIIF( iBsTempVal = 1, ' checked="" ', '' ) +
                                                'onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                   QuotedStr( cBsComponent + '=' + TUniControl( oObj ).Name ) + ', ' +
                                                   QuotedStr( 'field=' + cBsField ) + ' , ' +
                                                   QuotedStr( 'value=' + cBsTempVal ) + ' , ' +
                                                   QuotedStr( 'radio=' + iPos.ToString ) + ' , ' +
                                                   QuotedStr( 'query=' + cQuery ) + ' , ' +
                                                   QuotedStr( 'form=' + TComponent( pForm ).Name ) + '] );" name="customRadio' + TUniControl( oObj ).Name + '" id="customRadio' + TUniControl( oObj ).Name +
                                                      '"><label class="custom-control-label" for="customRadio' + TUniControl( oObj ).Name +
                                                      '">' + cBsCaption + '</label></div>';
                                     end;
                              end
                              else
                              if Pos( 'bsbtngroup' , cHint ) > 0 then
                              begin
                                     TUniLabel( oObj ).TextConversion := txtHTML;
                                     cBsTemp := Copy( cHint, Pos( '_' , cHint ) + 1 , 100 );
                                     cBsTemp := Copy( cBsTemp, 1, Pos( '__' , cBsTemp ) - 1 );
                                     iBsTempVal := StrToIntDef( cBsTemp , 0 );
                                     cBsCaption := Trim(Copy( cHint, Pos( '__' , cHint ) + 2 , 100 ) );

                                     //pPageControl := TUniPageControl( TComponent( pForm ).FindComponent( cBsCaption ) );

                                     //if pPageControl <> nil then
                                     begin
                                        varSL_HtmlPage.Add( '<div class="row">' );
                                        varSL_HtmlPage.Add( '  <div class="col-md-12 text-center">' );

                                        //for F := 0 to pPageControl.PageCount - 1 do
                                        begin
                                           varSL_HtmlPage.Add( '     <div class="btn-group btn-group-justified">' );
                                           //if pPageControl.Pages[ f ].TabVisible then
                                           begin

                                              //varSL_HtmlPage.Add( '        <button type="button" class="btn btn-primary">' + pPageControl.Pages[ i ].Caption + '</button>' );
                                              varSL_HtmlPage.Add( '        <button type="button" class="btn ' + 'ButtonThemeTab' + '">' + 'btn 1' + '</button>' );

                                           end;

                                           varSL_HtmlPage.Add( '     </div">' );

                                           varSL_HtmlPage.Add( '     <div class="btn-group">' );
                                           //if pPageControl.Pages[ f ].TabVisible then
                                           begin

                                              varSL_HtmlPage.Add( '        <button type="button" class="btn btn-primary">' + 'btn 2' + '</button>' );

                                           end;

                                           varSL_HtmlPage.Add( '     </div">' );

                                           varSL_HtmlPage.Add( '     <div class="btn-group">' );
                                           //if pPageControl.Pages[ f ].TabVisible then
                                           begin

                                              varSL_HtmlPage.Add( '        <button type="button" class="btn btn-primary">' + 'btn 3' + '</button>' );

                                           end;

                                           varSL_HtmlPage.Add( '     </div">' );

                                        end;

                                        varSL_HtmlPage.Add( '  </div">' );
                                        varSL_HtmlPage.Add( '</div">' );

                                        TUniControl( oObj ).Caption := varSL_HtmlPage.Text;

                                     end;
                              end
                              else
                              // don´t work
                              if Pos( 'bscardtabs_' , cHint ) > 0 then
                              begin
                                     varSL_HtmlPage.Clear;

                                     TUniLabel( oObj ).TextConversion := txtHTML;
                                     cBsComponent := trim( Copy( cHint, 1, Pos( '_' , cHint ) - 1 ) );

                                     cBsTemp := Copy( cHint, Pos( '_' , cHint ) + 1 , 100 );

                                     // todas as classes usadas ficam antes do nome do PAgeControl associado
                                     cBsClass := Copy( cBsTemp, 1, Pos( '__' , cBsTemp ) - 1 );

                                     if strTokenCount( cBsClass, '_' ) >= 1 then
                                     begin
                                        cBsColor := Copy( cBsClass, 1, Pos( '_' , cBsTemp ) - 1 );
                                        cBsClass := Copy( cBsClass, Pos( '_' , cBsTemp ) + 1, 20 );
                                     end
                                     else
                                     begin
                                        cBsColor := cBsClass;
                                        cBsClass := '';
                                     end;

                                     cBsTemp := Copy( cBsTemp, 1, Pos( '__' , cBsTemp ) - 1 );
                                     iBsTempVal := StrToIntDef( cBsTemp , 0 );
                                     cBsCaption := Trim(Copy( cHint, Pos( '__' , cHint ) + 2 , 100 ) );

                                     pPageControl := TUniPageControl( TComponent( pForm ).FindComponent( cBsCaption ) );

                                     if pPageControl <> nil then
                                     begin
                                         TUniPageControl(pPageControl).TabBarVisible := False;

                                         iReduc := varIIF( pMobileScreen, 1, 6 );

                                         // controlar o fluxo de abas pra nao estourar os linmites da tela
                                         pTabEnd := pTabIni + iReduc;

                                         if pTabEnd >= pPageControl.PageCount - 1 then
                                         begin
                                            pTabEnd := pPageControl.PageCount - 1;
                                            pTabIni := pTabEnd - iReduc;

                                            if pTabIni < 0 then
                                               pTabIni := 0;
                                         end;

                                         varSL_HtmlPage.Add( '     <div class="card card-primary card-outline card-outline-tabs>' );
                                         varSL_HtmlPage.Add( '        <div class="card-header p-0 border-bottom-0">' );
                                         varSL_HtmlPage.Add( '           <ul class="nav nav-tabs" id="custom-tabs-four-tab" role="tablist">' );

                                         for F := pTabIni to pTabEnd do
                                         begin
                                            if pPageControl.Pages[ f ].TabVisible then
                                            begin
                                               cTemp  := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Name );
                                               cTemp2 := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Caption );

                                               cBsTemp := IfThen( cTemp = pPageControl.ActivePage.Name , 'active' , '' );

                                               varSL_HtmlPage.Add( '         <li class="nav-item">' )  ;
                                               varSL_HtmlPage.Add( '            <a class="nav-link ' + cBsTemp + '" id="custom-tabs-four-' + pPageControl.Name + '-tab" data-toggle="pill" href="#custom-tabs-four-' + pPageControl.Name + '" onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                                                QuotedStr( cBsComponent + '=' + cTemp ) + ', ' +
                                                                                QuotedStr( 'tab=Tab' + f.ToString ) + ', ' +
                                                                                QuotedStr( 'form=' + TComponent( pForm ).Name ) + ', ' +
                                                                                QuotedStr( 'pgcontrol=' + pPageControl.Name ) + '] );" role="tab" aria-controls="custom-tabs-four-' + pPageControl.Name + '" aria-selected="' + varIIF( cBsTemp = 'active', 'true', 'false' )  + '">' +
                                                                                cTemp2 );
                                               varSL_HtmlPage.Add( '            </a>' );
                                               varSL_HtmlPage.Add( '         </li>' );                                                                                                                                                       //       ^
                                            end;
                                         end;

                                         varSL_HtmlPage.Add( '           </ul>' );
                                         varSL_HtmlPage.Add( '        </div>' );

                                         // complemento..

                                         varSL_HtmlPage.Add( '<div class="card-body">' );
                                         varSL_HtmlPage.Add( '  <div class="tab-content" id="custom-tabs-four-tabContent">' );

                                         for F := pTabIni to pTabEnd do
                                         begin
                                            if pPageControl.Pages[ f ].TabVisible then
                                            begin
                                               cTemp  := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Name );
                                               cTemp2 := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Caption );

                                               cBsTemp := IfThen( cTemp = pPageControl.ActivePage.Name , ' active show' , '' );

                                               varSL_HtmlPage.Add( '<div class="tab-pane fade' + cBsTemp + '" id="custom-tabs-four-' + pPageControl.Name + '" role="tabpanel" aria-labelledby="custom-tabs-four-' + pPageControl.Name + '-tab">' );
                                               varSL_HtmlPage.Add( '</div>' );
                                            end;
                                         end;

                                         varSL_HtmlPage.Add( '  </div>' );
                                         varSL_HtmlPage.Add( '</div>' );
                                         varSL_HtmlPage.Add( '      </div>' ); //final

                                         // bscardtabs
                                         TUniControl( TComponent( pForm ).Components[ I ] ).Caption := ( varSL_HtmlPage.Text );  //UTF8Encode
                                     end;
                              end
                              else
                              if Pos( 'bstabs:' , cHint ) > 0 then
                              begin
                                     //bsTabs_light_btn-sm__pgPadrao [[bsTabs:light cls:btn-sm pgc:pgPadrao]]

                                     varSL_HtmlPage.Clear;

                                     TUniLabel( oObj ).TextConversion := txtHTML;
                                     cBsComponent := trim( Copy( cHint, 1, Pos( ':' , cHint ) - 1 ) );

                                     cBsTemp := Copy( cHint, Pos( ':' , cHint ) + 1 , 100 );

                                     cBsColor := Copy( cBsTemp, 1, Pos ( ' ' , cBsTemp ) - 1 );

                                     cBsClass := Copy( cBsTemp, Pos( 'cls:' , cBsTemp ) + 4, 100 );
                                     cBsClass := Copy( cBsClass, 1, Pos ( ' ' , cBsClass ) - 1 );

                                     // todas as classes usadas ficam antes do nome do PAgeControl associado

                                     cBsTemp := Copy( cBsTemp, 1, Pos( '__' , cBsTemp ) - 1 );
                                     iBsTempVal := StrToIntDef( cBsTemp , 0 );
                                     cBsCaption := Trim(Copy( cHint, Pos( 'pgc:' , cHint ) + 4 , 100 ) );
                                     cBsCaption := Copy( cBsCaption, Pos( ' ' , cBsCaption ) - 1 );

                                     pPageControl := TUniPageControl( TComponent( pForm ).FindComponent( cBsCaption ) );

                                     if pPageControl <> nil then
                                     begin
                                         TUniPageControl(pPageControl).TabBarVisible := False;

                                         iReduc := varIIF( pMobileScreen, 1, 6 );

                                         // controlar o fluxo de abas pra nao estourar os linmites da tela
                                         pTabEnd := pTabIni + iReduc;

                                         if pTabEnd >= pPageControl.PageCount - 1 then
                                         begin

                                            pTabEnd := pPageControl.PageCount - 1;
                                            pTabIni := pTabEnd - iReduc;

                                            if pTabIni < 0 then
                                               pTabIni := 0;
                                         end;

                                         varSL_HtmlPage.Add( '<div class="row">' );
                                         varSL_HtmlPage.Add( '  <div class="col-md-12">' );
                                         varSL_HtmlPage.Add( '     <ul class="nav nav-tabs" id="custom-content-below-tab' + pPageControl.Name + '" role="tablist">' );

                                         for F := pTabIni to pTabEnd do
                                         begin
                                            if pPageControl.Pages[ f ].TabVisible then
                                            begin
                                               cTemp  := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Name );
                                               cTemp2 := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Caption );

                                               cBsTemp := IfThen( cTemp = pPageControl.ActivePage.Name , 'active color-gray' , 'color-silver' );

                                               varSL_HtmlPage.Add( '<li class="nav-item">' +
                                                                                 '  <a class="nav-link ' + cBsTemp + '" id="custom-content-below-home-tab' + pPageControl.Name + f.ToString + '" data-toggle="pill" href="#custom-content-below-home-tab' + pPageControl.Name + '" onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                                         QuotedStr( cBsComponent + '=' + cTemp ) + ', ' +
                                                                         QuotedStr( 'tab=Tab' + f.ToString ) + ', ' +
                                                                         QuotedStr( 'form=' + TComponent( pForm ).Name ) + ', ' +
                                                                         QuotedStr( 'pgcontrol=' + pPageControl.Name ) + '] );" role="tab" aria-controls="custom-content-below-home" aria-selected="' + varIIF( Pos( 'active' , cBsTemp ) > 0, 'true', 'false' )  + '">' +
                                                                         cTemp2 +
                                                                         '</a></li>' );                                                               //       ^
                                                                         // btn-xs -> Mini                                                                     |
                                                                         // btn-sm -> Small  ------------------------------------------------------------------
                                                                         // btn-lg -> Large
                                                                         // no class> Default
                                            end;
                                         end;

                                         varSL_HtmlPage.Add( '     </ul>' );
                                         varSL_HtmlPage.Add( '  </div>' );
                                         varSL_HtmlPage.Add( '</div>' );

                                         // bstabs
                                         TUniControl( TComponent( pForm ).Components[ I ] ).Caption := RemoveLineBreaks( varSL_HtmlPage.Text );  //UTF8Encode
                                     end;
                              end
                              else
                              if Pos( 'bspills:' , cHint ) > 0 then
                              begin
                                     varSL_HtmlPage.Clear;

                                     TUniLabel( oObj ).TextConversion := txtHTML;
                                     cBsComponent := trim( Copy( cHint, 1, Pos( ':' , cHint ) - 1 ) );

                                     cBsTemp := Copy( cHint, Pos( ':' , cHint ) + 1 , 100 );

                                     cBsColor := Copy( cBsTemp, 1, Pos ( ' ' , cBsTemp ) - 1 );

                                     cBsClass := Copy( cBsTemp, Pos( 'cls:' , cBsTemp ) + 4, 100 );
                                     cBsClass := Copy( cBsClass, 1, Pos ( ' ' , cBsClass ) - 1 );

                                     // todas as classes usadas ficam antes do nome do PAgeControl associado
                                     cBsTemp := Copy( cBsTemp, 1, Pos( '__' , cBsTemp ) - 1 );
                                     iBsTempVal := StrToIntDef( cBsTemp , 0 );
                                     cBsCaption := Trim(Copy( cHint, Pos( 'pgc:' , cHint ) + 4 , 100 ) ) + ' '; // v. 3.2.0.8
                                     cBsCaption := Copy( cBsCaption, 1, Pos( ' ' , cBsCaption ) - 1 );             // v. 3.2.0.8

                                     pPageControl := TUniPageControl( TComponent( pForm ).FindComponent( cBsCaption ) );

                                     if pPageControl <> nil then
                                     begin
                                         TUniPageControl(pPageControl).TabBarVisible := False;

                                         TUniLabel( oObj ).Align := alNone;
                                         oObjTemp := TUniControl( TUniLabel( oObj ).GetParentComponent );
                                         iReduc := 6;

                                         if mm.varB_Mobile_Screen then
                                         begin
                                              iReduc := varIIF( mm.varB_Mobile_Screen_Portrait, 1, 6 );
                                         end;

                                         if GetPropInfo( oObjTemp.ClassInfo, 'AutoScroll' ) <> nil then
                                            TUniContainerPanel( oObjTemp ).AutoScroll := False ;

                                         TUniLabel( oObj ).Left  := 8;
                                         TUniLabel( oObj ).width := oObjTemp.Width - 8;

                                         // controlar o fluxo de abas pra nao estourar os linmites da tela
                                         pTabEnd := pTabIni + iReduc;

                                         if pTabEnd >= pPageControl.PageCount - 1 then
                                         begin
                                            pTabEnd := pPageControl.PageCount - 1;
                                            pTabIni := pTabEnd - iReduc;

                                            if pTabIni < 0 then
                                               pTabIni := 0;
                                         end;

                                         varSL_HtmlPage.Add( '<div class="row" >' );
                                         varSL_HtmlPage.Add( '  <div class="col-md-12">' );
                                         // v. 3.2.0.0
                                         if mm.RTL then
                                            varSL_HtmlPage.Add( '     <div class="rc-btn-group-rtl btn-group-justified">' )
                                         else
                                            varSL_HtmlPage.Add( '     <div class="btn-group btn-group-justified">' );

                                         for F := pTabIni to pTabEnd do
                                         begin
                                            if pPageControl.Pages[ f ].TabVisible then
                                            begin
                                               cTemp  := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Name );
                                               cTemp2 := trim( TUniTabSheet( pPageControl.Pages[ f ] ).Caption );

                                               cCloseBtn := 'tab=_closeTab';
                                               If Pos( 'closebtn:false' , TUniTabSheet( pPageControl.Pages[ f ] ).Hint ) > 0 then
                                                  cCloseBtn := '';

                                               if Pos( '<span>', cTemp2 ) = 0 then
                                                  cTemp2 := '<i class=""></i><span> ' + cTemp2 + '</span>';

                                               cTemp3 := '';
                                               if ( TUniTabSheet( pPageControl.Pages[ f ] ).Name = pPageControl.ActivePage.Name ) and ( cCloseBtn <> '' ) then
                                               begin
                                                  cTemp3 := '<i class="fas fa-times"></i>';
                                               end;

                                               if ( ( f > 0 ) and ( f = pTabIni ) ) and ( pPageControl.PageCount - 1 > ( iReduc ) ) then // and ( f = 0 ) then
                                               begin
                                                  cBsTemp := 'ButtonThemeTab';

                                                  varSL_HtmlPage.Add( '        <button onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                                            QuotedStr( cBsComponent + '=' + cTemp ) + ', ' +
                                                                            QuotedStr( 'tab=TabLeft' ) + ', ' +
                                                                            QuotedStr( 'form=' + TComponent( pForm ).Name ) + ', ' +
                                                                            QuotedStr( 'pgcontrol=' + pPageControl.Name ) + '] );" id="' + pPageControl.Name + '_Tab' + f.ToString + '" type="button" class="btn ' + cBsClass + ' ' + cBsTemp + '">' + '<i class="fa fa-arrow-left fa-1x"></i>' +
                                                                            '</button>' );                                                               //       ^
                                               end;

                                               cBsTemp := IfThen( cTemp = pPageControl.ActivePage.Name , 'ButtonThemeTab' , 'ButtonThemeInactive' );

                                               varSL_HtmlPage.Add( '    <button onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                                            QuotedStr( cBsComponent + '=' + cTemp ) + ', ' +
                                                                            QuotedStr( 'tab=Tab' + f.ToString ) + ', ' +
                                                                            QuotedStr( 'form=' + TComponent( pForm ).Name ) + ', ' +
                                                                            QuotedStr( 'pgcontrol=' + pPageControl.Name ) + '] );" id="' + pPageControl.Name + f.ToString + '_TabLeft" type="button" class="btn ' + cBsClass + ' ' + cBsTemp + '">' + cTemp2 +

                                                                            IfThen( ( cTemp3 <> '' ) and ( pPageControl.ActivePageIndex > 0 ) , '<a onclick="ajaxRequest( MainForm.htmlFrame , ' + QuotedStr( cBsComponent ) + ' , [' +
                                                                                                   QuotedStr( cBsComponent + '=' + cTemp ) + ', ' +
                                                                                                   QuotedStr( cCloseBtn ) + ', ' + //QuotedStr( 'tab=_closeTab' ) + ', ' +
                                                                                                   QuotedStr( 'form=' + TComponent( pForm ).Name ) + ', ' +
                                                                                                   QuotedStr( 'pgcontrol=' + pPageControl.Name ) +

                                                                                                   ']);"><span> ' + cTemp3 + '</span></a>', '' ) +
                                                                         '</button>' );                                                               //       ^

                                                // close all
                                                if ( f = pTabEnd ) and ( pTabEnd > 1 ) and ( Pos( 'closeall:off', TUniLabel( oObj ).Hint ) = 0 ) then // v. 3.2.0.8
                                                begin
                                                    cBsTemp := 'ButtonThemeTab';//'ButtonThemeCloseAllTab';

                                                    varSL_HtmlPage.Add( '        <button onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                                              QuotedStr( cBsComponent + '=' + cTemp ) + ', ' +
                                                                              QuotedStr( 'tab=_closeAllTabs' ) + ', ' +
                                                                              QuotedStr( 'form=' + TComponent( pForm ).Name ) + ', ' +
                                                                              QuotedStr( 'pgcontrol=' + pPageControl.Name ) + '] );" id="' + pPageControl.Name + f.ToString + '_closeAllTabs" type="button" class="btn ' + cBsClass + ' ' + cBsTemp + '">' + '<i class="fas fa-window-close"></i>' +
                                                                              '</button>' );                                                               //       ^

                                                end;

                                                if ( pPageControl.PageCount - 1 > ( iReduc ) ) and ( ( f = pTabEnd ) and ( f <> pPageControl.PageCount - 1 ) ) then
                                                begin
                                                   cBsTemp := 'ButtonThemeTab';
                                                   varSL_HtmlPage.Add( '        <button onclick="ajaxRequest( MainForm.htmlFrame, ' + QuotedStr( cBsComponent ) + ' , [' +
                                                                             QuotedStr( cBsComponent + '=' + cTemp ) + ', ' +
                                                                             QuotedStr( 'tab=TabRight' ) + ', ' +
                                                                             QuotedStr( 'form=' + TComponent( pForm ).Name ) + ', ' +
                                                                             QuotedStr( 'pgcontrol=' + pPageControl.Name ) + '] );" id="' + pPageControl.Name + f.ToString + '_TabRight" type="button" class="btn ' + cBsClass + ' ' + cBsTemp + '">' + '<i class="fa fa-arrow-right fa-1x"></i>' +
                                                                             '</button>' );                                                               //       ^

                                                end;
                                            end;
                                         end;

                                         varSL_HtmlPage.Add( '     </div>' );
                                         varSL_HtmlPage.Add( '  </div>' );
                                         varSL_HtmlPage.Add( '</div>' );
                                         //pills
                                         TUniControl( TComponent( pForm ).Components[ I ] ).Caption := RemoveLineBreaks( varSL_HtmlPage.Text );  //UTF8Encode
                                     end;
                              end;
                           end;
                        end
                        else
                        if ( oObj is TUniHTMLFrame ) then
                        begin
                             if TUniControl( oObj ).Name = 'hfImg1' then
                                iw := iw;

                            cTemp := rc_NormalizeHintProperty( cHint );
                            cTemp := RemoveLineBreaks( cTemp );
                            cTemp := Copy( cTemp, 1, Pos( ':' , cTemp ) - 1 );

                            if ( Pos( cTemp, BS_COMPONENTS ) > 0 ) and ( cHint <> '' ) then
                            begin
                               varSL_HtmlPage.Clear;
                               // bscarousel
                               if Pos( 'bscarousel:' , cHint ) > 0 then
                               begin
                                  varSL_HtmlPage.Add( '<div class="container">' );
                                  varSL_HtmlPage.Add( '<div id="carouselIndicators" class="carousel slide" data-ride="carousel">' );

                                  varSL_HtmlPage.Add( '   <ol class="carousel-indicators">' );

                                  cTemp := rc_NormalizeHintProperty( cHint );
                                  cTemp := RemoveLineBreaks( cTemp );
                                  iPos := Occurs( 'bscarousel:', cTemp );
                                  for f := 0 to iPos - 1 do
                                      varSL_HtmlPage.Add( '      <li data-target="#carouselIndicators" data-slide-to="' + f.ToString + '" class="' + varIIF( f = 0 , 'active', '' ) + '"></li>' );

                                  varSL_HtmlPage.Add( '   </ol>' );

                                  varSL_HtmlPage.Add( '   <div class="carousel-inner">' );

                                  //bsCarousel_https://placehold.it/900x500/39CCCC/ffffff?text=RadCORE+WEB[Slide 1#Demonstrando BS_Carousel]@https://www.radcore.pro.br@Powered by RadCORE

                                  cHint := RemoveLineBreaks( cHintDefault );
                                  cTemp2 := cHint;
                                  iPos := 0;
                                  While ( Pos( 'bscarousel:' , cTemp2.ToLower ) > 0 ) do
                                  begin
                                       cTemp3 := rc_GetHintProperty( 'bscarousel:', cTemp2 );

                                       // no cache
                                       //cTemp3 := cTemp3 + '?' + FormatDateTime('ddmmyyyyhhmmss', Now);

                                       varSL_HtmlPage.Add( '    <div class="carousel-item' + varIIF( iPos = 0 , ' active', '' ) + '">' );
                                       varSL_HtmlPage.Add( '      <img style="width:100%;" src="' + cTemp3 + '" alt="slide' + iPos.ToString + '">' );
                                       varSL_HtmlPage.Add( '    </div>' );

                                       Inc( iPos );

                                       cTemp2 := Trim( StringReplace( cTemp2 , 'bscarousel:' + cTemp3 + '|' , '', [rfReplaceAll] ));
                                  end;

                                  varSL_HtmlPage.Add( '  </div>' );
                                  varSL_HtmlPage.Add( '  <a class="carousel-control-prev" id="btncarouselprev" href="#carouselIndicators" role="button" data-slide="prev">' );
                                  varSL_HtmlPage.Add( '    <span class="carousel-control-prev-icon" aria-hidden="true"></span>' );
                                  varSL_HtmlPage.Add( '    <span class="sr-only">Previous</span>' );
                                  varSL_HtmlPage.Add( '  </a>' );
                                  varSL_HtmlPage.Add( '  <a class="carousel-control-next" id="btncarouselnext" href="#carouselIndicators" role="button" data-slide="next">' );
                                  varSL_HtmlPage.Add( '    <span class="carousel-control-next-icon" aria-hidden="true"></span>' );
                                  varSL_HtmlPage.Add( '    <span class="sr-only">Next</span>' );
                                  varSL_HtmlPage.Add( '  </a>' );
                                  varSL_HtmlPage.Add( ' </div>' );
                                  varSL_HtmlPage.Add( '</div>' );

                                  varSL_HtmlPage.Text := RemoveLineBreaks( varSL_HtmlPage.Text );
                                  varSL_HtmlPage.Text := StringReplace( varSL_HtmlPage.Text, '?', '&amp;', [rfReplaceAll] );
                               end
                               else
                               // qrcode with bugfix to solve
//                               if Pos( 'bsqrcode:' , cHint ) > 0 then
//                               begin
//                                    cTemp3 := rc_GetHintProperty( 'bsqrcode:', cHint );
//                                    UniSession.AddJS( 'updateQRCode("' + 'rcQrCodeViewer_' + TUniControl( oObj ).Parent.Name + '", "' + cTemp3  + '", 3 );' );
//                               end
//                               else
                               if Pos( 'bsimg:' , cHint ) > 0 then
                               begin
                                      cTemp :='<img id="bsimg' + TUniControl( oObj ).name + '" ' +
                                              'class="img-responsive" ' +  //img-fluid mx-auto d-block
                                              'src="bsimgfile" ' +
                                              'alt="bsimg-' + TUniControl( oObj ).name + '">' ;

                                      cHint := RemoveLineBreaks( cHint );
                                      cHint := trim( rc_NormalizeHintProperty( cHint )) + ' ';

                                      iH := TUniControl( TUniControl( oObj ).GetParentComponent ).Height;

                                      // todo conteudo de bsimg
                                      cTemp3 := rc_GetHintProperty( 'bsimg:', cHint );

                                      //apenas o img
                                      cTemp2 := rc_GetHintProperty( 'bsimg:', cHint, true );
                                      cTemp  := StringReplace( cTemp, 'bsimgfile', cTemp2 , [rfReplaceAll] );

                                      cTemp2 := Copy( cTemp3, Pos( 'width-', cTemp3 ), 1000 ) + ' |';
                                      cTemp4 := Copy( cTemp2, 1, Pos( 'height-', cTemp2 )  );

                                      if StrToIntDef( cTemp4, 0 ) = 0 then
                                      begin
                                           cTemp2 := IntToStr( TUniControl( TUniControl( oObj ).GetParentComponent ).Width );
                                      end
                                      else
                                      if ( mm.varB_Mobile_Screen_Portrait )  then
                                      begin
                                         cTemp2 := rc_GetHintProperty( 'mobile-v-', cTemp4, True );
                                      end
                                      else
                                      if ( mm.varB_Mobile_Screen_Landscape )  then
                                         cTemp2 := rc_GetHintProperty( 'mobile-h-', cTemp4, True )
                                      else
                                         cTemp2 := rc_GetHintProperty( 'width-', cTemp4, True );

                                      iw := Trunc( StrToIntDef( cTemp2, 560 ) ) ;
                                      //ih := Trunc( StrToIntDef( cTemp2, iw ) * ( 60.71 / 100 ) ) ;

                                      cTemp2 := Copy( cTemp3, Pos( 'height-', cTemp3 ), 1000 ) + ' |';
                                      cTemp4 := cTemp2;

                                      if StrToIntDef( cTemp4, 0 ) = 0 then
                                      begin
                                           cTemp2 := IntToStr( TUniControl( TUniControl( oObj ).GetParentComponent ).Height );
                                           ih     := StrToIntDef( cTemp2, ih );
                                      end
                                      else
                                      if ( mm.varB_Mobile_Screen_Portrait )  then
                                      begin
                                         cTemp2 := rc_GetHintProperty( 'mobile-v-', cTemp4, True );
                                      end
                                      else
                                      if ( mm.varB_Mobile_Screen_Landscape )  then
                                         cTemp2 := rc_GetHintProperty( 'mobile-h-', cTemp4, True )
                                      else
                                         cTemp2 := rc_GetHintProperty( 'height-', cTemp4, True );

                                      TUniControl( oObj ).Width  := iW;
                                      TUniControl( oObj ).Height := TUniControl( oObj ).Parent.Height;

                                      varSL_HtmlPage.Text := StringReplace( cTemp, '?', '&amp;', [rfReplaceAll] );
                               end
                               else
                               // bsvideo
                               if Pos( 'bsvideo:' , cHint ) > 0 then
                               begin
                                  if Pos( 'youtube.com', cHint ) = 0 then
                                  begin
                                     cTemp := '<div class="video-file-responsive"><video width="100%" heigth="100%"' ;

                                     if Pos ( ' controls', cHint ) > 0 then
                                        cTemp := cTemp + ' controls';
                                     if Pos ( ' muted', cHint ) > 0 then
                                        cTemp := cTemp + ' muted';
                                     if Pos ( ' poster', cHint ) > 0 then
                                        cTemp := cTemp + ' poster';
                                     if Pos ( ' autoplay', cHint ) > 0 then
                                        cTemp := cTemp + ' autoplay';
                                     if Pos ( ' loop', cHint ) > 0 then
                                        cTemp := cTemp + ' loop';

                                     cTemp2 := StringReplace( cHintDefault  , ' controls'  , '' , [rfReplaceAll] );
                                     cTemp2 := StringReplace( cTemp2        , ' muted'     , '' , [rfReplaceAll] );
                                     cTemp2 := StringReplace( cTemp2        , ' poster'    , '' , [rfReplaceAll] );
                                     cTemp2 := StringReplace( cTemp2        , ' autoplay'  , '' , [rfReplaceAll] );
                                     cTemp2 := StringReplace( cTemp2        , ' loop'      , '' , [rfReplaceAll] );
                                     cTemp2 := StringReplace( cTemp2        , '|'          , '' , [rfReplaceAll] );

                                     varSL_HtmlPage.Add( cTemp + '>' );

                                     iPos := 0;
                                     While ( Pos( 'bsvideo:' , cTemp2.ToLower ) > 0 ) do
                                     begin
                                          cTemp2 := rc_GetHintProperty( 'bsvideo:', cHint, true );
                                          if Pos( 'bsvideo:' , cTemp2.ToLower ) > 0 then
                                             cTemp := Copy( cTemp2 , 1, Pos( 'bsvideo:' , cTemp2.ToLower ) - 1 )
                                          else
                                          if cTemp2 <> '' then
                                             cTemp := cTemp2
                                          else
                                             cTemp := cTemp2;

                                          cTemp := Trim( RemoveLineBreaks( cTemp ) );

                                          varSL_HtmlPage.Add( '   <source src="' + cTemp + '" type="video/' + Copy( ExtractFileExt( cTemp ), 2, 10 ) + '">' );

                                          Inc( iPos );

                                          cTemp2 := Trim( StringReplace( cTemp2 , cTemp, '', [rfReplaceAll] ));
                                     end;

                                     varSL_HtmlPage.Add( '  </video>' );

                                     varSL_HtmlPage.Text := RemoveLineBreaks( varSL_HtmlPage.Text );
                                     varSL_HtmlPage.Text := StringReplace( varSL_HtmlPage.Text, '?', '&amp;', [rfReplaceAll] ) + '</div';
                                  end
                                  else
                                  begin
                                      cTemp := '<div class="video-tube-responsive">' +
                                                 '<iframe width="ytw" height="yth" ' +
                                                 'src="ytsrc" ' +
                                                 'title="YouTube video player" frameborder="0" ' +
                                                 'allow="accelerometer; autoplay; clipboard-write; ' +
                                                 'encrypted-media; gyroscope; picture-in-picture" allowfullscreen>' +
                                                 '</iframe>' +
                                               '</div>' ;
//                                               '<iframe width="1280" height="720" ' +
//                                               'src="https://www.youtube.com/embed/feVEDq7WTeQ"' +
//                                               'title="YouTube video player" frameborder="0" ' +
//                                               'allow="accelerometer; autoplay; clipboard-write; ' +
//                                               'encrypted-media; gyroscope; picture-in-picture" allowfullscreen>' +
//                                               '</iframe>'
(*
                                                 '<div class="video-tube-responsive">' +
                                                   '<iframe width="560" height="339" ' +
                                                   'src="https://www.youtube.com/embed/feVEDq7WTeQ    width-560 mobile-h-560 mobile-v-295   height-340 mobile-h-340 mobile-v-180" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>'#$D#$A
*)

                                      cHint := RemoveLineBreaks( cHint );
                                      cHint := trim( rc_NormalizeHintProperty( cHint )) + ' ';

                                      iH := TUniControl( TUniControl( oObj ).GetParentComponent ).Height;
                                      // todo conteudo de bsvideo
                                      cTemp3 := rc_GetHintProperty( 'bsvideo:', cHint );
                                      // v. 3.2.0.9
                                      //apenas o video
                                      cTemp2 := rc_GetHintProperty( 'bsvideo:', cHint );//, true );
                                      cTemp2 := Copy( cTemp2, 1, Pos( ' ', cTemp2 ) - 1 );
                                      cTemp := StringReplace( cTemp, 'ytsrc', cTemp2 , [rfReplaceAll] );

                                      cTemp2 := Copy( cTemp3, Pos( 'width-', cTemp3 ), 1000 ) + ' |';
                                      cTemp4 := Copy( cTemp2, 1, Pos( 'height-', cTemp2 )  );

                                      if ( mm.varB_Mobile_Screen_Portrait )  then
                                      begin
                                         cTemp2 := rc_GetHintProperty( 'mobile-v-', cTemp4, True );
                                      end
                                      else
                                      if ( mm.varB_Mobile_Screen_Landscape )  then
                                         cTemp2 := rc_GetHintProperty( 'mobile-h-', cTemp4, True )
                                      else
                                         cTemp2 := rc_GetHintProperty( 'width-', cTemp4, True );

                                      cTemp := StringReplace( cTemp, '"ytw"', '"' + cTemp2 + '"' , [rfReplaceAll] );

                                      TUniControl( oObj ).Height := iH;

                                      iw := Trunc( StrToIntDef( cTemp2, 560 ) ) ;
                                      ih := Trunc( StrToIntDef( cTemp2, iw ) * ( 60.71 / 100 ) ) ;

                                      cTemp2 := Copy( cTemp3, Pos( 'height-', cTemp3 ), 1000 ) + ' |';
                                      cTemp4 := cTemp2;

                                      if ( mm.varB_Mobile_Screen_Portrait )  then
                                      begin
                                         cTemp2 := rc_GetHintProperty( 'mobile-v-', cTemp4, True );
                                      end
                                      else
                                      if ( mm.varB_Mobile_Screen_Landscape )  then
                                         cTemp2 := rc_GetHintProperty( 'mobile-h-', cTemp4, True )
                                      else
                                         cTemp2 := rc_GetHintProperty( 'height-', cTemp4, True );

                                      cTemp2 := IntToStr( ih );

                                      cTemp := StringReplace( cTemp, '"yth"', '"' + cTemp2 + '"' , [rfReplaceAll] );

                                      TUniControl( oObj ).Parent.Height := iH;

                                      TUniControl( oObj ).Width  := iW;
                                      TUniControl( oObj ).Height := iH;

                                      varSL_HtmlPage.Text := StringReplace( cTemp, '?', '&amp;', [rfReplaceAll] );
                                  end;
                               end;

                               TUniHTMLFrame( oObj ).HTML.Text :=  varSL_HtmlPage.Text;
                            end;
                        end
                        else
                        if ( oObj is TUniPanel ) or
                           ( oObj is TUniContainerPanel ) then
                        begin
                           cTemp := Copy( cHint, 1, Pos( '_' , cHint ) - 1 );

                           if Pos( cTemp, BS_COMPONENTS ) > 0 then
                           begin
                              if ( Pos( 'bscard_' , cHint ) > 0 ) or
                                 ( Pos( 'bscardheader' , cHint ) > 0 ) or
                                 ( Pos( 'bscardfooter' , cHint ) > 0 ) then
                              begin
                                     TUniControl( oObj ).BorderStyle := ubsNone;

                                     cBsCaption := '';
                                     if Pos( 'bscard__' , cHint ) > 0 then
                                     begin
                                        cBsType := '';
                                        TUniControl( oObj ).JSInterface.JSCall( 'addCls' , ['clsRoundPanelForm']);
                                     end
                                     else
                                     begin
                                         if ( Pos( 'bscardheader_' , cHint ) > 0 ) or
                                            ( Pos( 'bscardfooter_' , cHint ) > 0 ) then
                                         begin
                                            cBsType := Copy( cHintDefault, Pos( '_' , cHint ) + 1 , 100 );
                                            cBsType := Copy( cBsType, 1, Pos( '__' , cBsType ) - 1 );
                                            cBsCaption := Trim( Copy( cHintDefault, Pos( '__' , cHintDefault ) + 2 , 100 ));
                                         end;

                                         if Pos( 'bscardheader_' , cHint ) > 0 then
                                         begin
                                            TUniControl( oObj ).JSInterface.JSCall( 'update', [
                                                                                                   '<div class="card card-' + cBsType + '">'+ //card-themecrud">' + // card-outline
                                                                                                   '     <div class="card-header">'+
                                                                                                   '        <h3 class="card-title">' + cBsCaption + '</h3>'+
                                                                                                   '     </div>'+
                                                                                                   '</div>'
                                             ]);
                                         end
                                         else
                                         if Pos( 'bscardfooter_' , cHint ) > 0 then
                                         begin
                                            TUniControl( oObj ).JSInterface.JSCall( 'update', [
                                                                                                  '     <div class="card-footer">'+
                                                                                                  '     </div>'
                                            ]);
                                         end;

                                         //remove o caption do panel
                                         TUniControl( oObj ).Caption := cBsCaption;

                                     end;
                                     //remove o caption do panel
                                     TUniControl( oObj ).Caption := '';
                              end;
                           end;
                        end;
                    end;

                    if pOnlyThisObj <> nil then
                       Break;
                 end;
             except on e:exception do
                    begin
                         dm_rc.rc_ShowError( 'rc_BootStrapRenderExecute ( ' + i.ToString + ' | obj: ' + TUniControl( oObj ).name + ') : ' + e.Message  );
                    end;
             End;
         end;
     end;
     //UniSession.ResumeLayouts();
     varSL_HtmlPage.Free;
end;

procedure rc_DynamicAlignment( pFrame: TObject );
var
   oComponent : TComponent;
   oObjTemp, oObjTemp2 : TUniControl;

   cCaption,
   cCmd, cTemp, cTemp2, cTemp3, cTemp4, cHint : string;

   iOffSet,

   i,n,x,y,w,h, iLeft, iTop, iRight, iBottom, iWidth, iHeight,
   iPos, iPos2, iTemp : integer;

   bDots : boolean;
begin
   // align components
   //
   // [[cls:btngreen | align:btncancel r:-10]]
   // [[cls:btnred | align:memo l:0 b:4]]
   // [[center:parent xy]]

   x := 0;
   oObjTemp := nil;

   //UniSession.SuspendLayouts();
   try
      for I := 1 to TComponent(pFrame).ComponentCount - 1 do
      begin
         oObjTemp  := TUniControl( TComponent(pFrame).Components[ I ] );

         // conflito com novo col-attr: ( uniDbGrid só recebe col-attr como atributos )
         If ( Pos( 'TAction' , TComponent( pFrame ).Components[I].ClassName ) = 0 ) and
            ( Pos( 'TUniDBGrid' , TComponent( pFrame ).Components[I].ClassName ) = 0 ) then
         begin
            if GetPropInfo( oObjTemp.ClassInfo, 'Hint' ) <> nil then
            begin
                cHint :=  oObjTemp.Hint;

                if Pos( '[[' , oObjTemp.Hint ) > 0 then
                begin
                   cTemp3  := oObjTemp.Hint;

                   if ( oObjTemp is TUniLabel ) then
                   begin
                      // FONT responsive
                      // font-size:50 mobile-v-24 mobile-h-32 |
                      cTemp := rc_GetHintProperty( 'fontsize-r:', cTemp3 );

                      if cTemp <> '' then
                      begin
                         iPos := StrToIntDef( Copy( cTemp, 1, Pos( ' ', cTemp ) - 1 ), TUnilabel( oObjTemp ).Font.Size );

                         if mm.varB_Mobile_Screen_Portrait then
                         begin
                            iPos  := Pos( 'mobile-v-' , cTemp ) + 9;
                            cTemp := Copy( cTemp, iPos, 100 );
                            cTemp := Copy( cTemp, 1, Pos( ' ', cTemp ) - 1 );
                            iPos  := StrToIntDef( cTemp, TUnilabel( oObjTemp ).Font.Size );
                         end
                         else
                         if mm.varB_Mobile_Screen_Landscape then
                         begin
                            iPos  := Pos( 'mobile-h-' , cTemp ) + 9;
                            cTemp := Copy( cTemp, iPos, 100 ) + ' ';
                            cTemp := Copy( cTemp, 1, Pos( ' ', cTemp ) - 1 );
                            iPos  := StrToIntDef( cTemp, TUnilabel( oObjTemp ).Font.Size );
                         end;

                         TUnilabel( oObjTemp ).Font.Size := iPos;
                      end;

                      // caption-dots
                      //
                      // mobile-v  : in MOBILE PORTRAIT MODE
                      // mobile-h  : in MOBILE LANDSCAPE MODE
                      // mobile    : in MOBILE MODE
                      cTemp3 := rc_GetHintProperty( 'caption-dots:', cHint );

                      if cTemp3 <> '' then
                      begin
                         cTemp3 := rc_GetHintProperty( 'caption-dots:', cHint );
                         cTemp4 := rc_GetHintProperty( 'caption-dots-default:', cHint );

                         if Pos(  '...', oObjTemp.Caption ) = 0 then
                            oObjTemp.Hint := rc_SetHintProperty( oObjTemp.Caption, 'caption-dots-default:', oObjTemp.Hint );

                         iTemp  := StrToIntDef( ReturnNumbers( cTemp3 ), 0 );

                         bDots  := ( ( Pos( 'mobile-v-', cTemp3 ) > 0 ) and ( mm.varB_Mobile_Screen_Portrait ) ) or
                                   ( ( Pos( 'mobile-h-', cTemp3 ) > 0 ) and ( mm.varB_Mobile_Screen_Landscape ) ) or
                                   ( ( Pos( 'mobile-', cTemp3 ) > 0 )   and ( mm.varB_Mobile_Screen_Portrait ) );

                         if ( bDots ) and ( Length( oObjTemp.Caption ) >= iTemp ) then
                            oObjTemp.Caption := Copy( oObjTemp.Caption, 1, iTemp ) + '...'
                         else
                         if ( cTemp4 <> '' ) then
                            oObjTemp.Caption := cTemp4;
                      end;

                   end
                   else
                   if ( oObjTemp is TUniBitBtn ) then
                   begin
                      // caption-hide
                      //
                      // mobile-v  : in MOBILE PORTRAIT MODE
                      // mobile-h  : in MOBILE LANDSCAPE MODE
                      // mobile    : in MOBILE MODE
                      if Pos( 'caption-hide:', cHint ) > 0 then
                      begin
                         cTemp3 := ( rc_GetHintProperty( 'caption-hide:', cHint ) );

                         cCaption := Copy( oObjTemp.Caption, 1, Pos( '</span>', oObjTemp.Caption ) - 1 );
                         cCaption := ReverseStr( cCaption );
                         cCaption := ReverseStr( Copy( cCaption, 1, Pos( '>', cCaption )-1 ) );

                         cTemp4   := rc_GetHintProperty( 'caption:', cHint );

                         TUniControl( oObjTemp ).Caption := StringReplace( oObjTemp.Caption, cCaption, '[-]', [rfReplaceAll] );

                         if ( cTemp3 = 'mobile-v' ) and
                            ( mm.varB_Mobile_Screen_Portrait ) then
                            cTemp4 := ''
                         else
                         if ( cTemp3 = 'mobile-h' ) and
                            ( mm.varB_Mobile_Screen_Landscape ) then
                            cTemp4 := ''
                         else
                         if ( cTemp3 = 'mobile' ) and
                            ( mm.varB_Mobile_Screen_Portrait ) then
                            cTemp4 := '';

                         if cCaption <> '' then
                            TUniControl( oObjTemp ).Caption := StringReplace( oObjTemp.Caption, '[-]' ,cTemp4 , [rfReplaceAll] )
                         else
                         begin
                              cCaption := Copy( oObjTemp.Caption, 1, Pos( '></span>', oObjTemp.Caption ) );
                              cCaption := cCaption + cTemp4 + '</span>';
                              TUniControl( oObjTemp ).Caption := cCaption;
                         end;
                      end;
                   end;

                   cTemp2 := rc_NormalizeHintProperty( oObjTemp.Hint );
                   oObjTemp.Hint := '[[' + cTemp2 + ']]';

                   cTemp2 := cTemp2 + '|';

                   cCmd := cTemp2;

                   iPos2 := Pos( '|' , cTemp2 );

                   While ( iPos2 > 0 ) do
                   begin
                        cTemp  := Trim( Copy( cCmd, 1 , iPos2 ) );
                        cTemp2 := Trim( StringReplace( cCmd, cTemp, '', [rfReplaceAll] ) );

                        cCmd := cTemp2;

                        cTemp  := StringReplace( cTemp, '|', '', [rfReplaceAll] ) + ' ';

                        // hidden
                        //
                        // mobile-v  : in MOBILE PORTRAIT MODE
                        // mobile-h  : in MOBILE LANDSCAPE MODE
                        // mobile    : in MOBILE MODE
                        cTemp3 := ( rc_GetHintProperty( 'hide:', cTemp ) );
                        if cTemp3 <> '' then
                        begin
                           if ( cTemp3 = 'mobile-v' ) and
                              ( mm.varB_Mobile_Screen_Portrait ) then
                              oObjTemp.Visible := False
                           else
                           if ( cTemp3 = 'mobile-h' ) and
                              ( mm.varB_Mobile_Screen_Landscape ) then
                              oObjTemp.Visible := False
                           else
                            if ( cTemp3 = 'mobile' ) and
                              ( mm.varB_Mobile_Screen ) then
                              oObjTemp.Visible := False
                            else
                               oObjTemp.Visible := True;
                        end;

                        cTemp3 := rc_GetHintProperty( 'disable:', cTemp ) ;

                        if cTemp3 <> '' then
                        begin
//                             if ( cTemp3 = 'mobile-v' ) and
//                                ( mm.varB_Mobile_Screen_Portrait ) then
//                             begin
//                                  oObjTemp.Enabled := False;
//                             end
//                             else
//                             if ( cTemp3 = 'mobile-h' ) and
//                                ( mm.varB_Mobile_Screen_Landscape ) then
//                             begin
//                                  oObjTemp.Enabled := False;
//                             end
//                             else
//                              if ( cTemp3 = 'mobile' ) and
//                                ( mm.varB_Mobile_Screen ) then
//                             begin
//                                  oObjTemp.Enabled := False;
//                             end
//                             else
//                             begin
//                                  oObjTemp.Enabled := True;
//                             end;
                        end;

                        if ( oObjTemp.Visible ) and ( oObjTemp.Enabled ) then
                        begin
                            //pos-l:5%
                            if Pos( 'pos-l:', cTemp ) > 0 then
                            begin
                               // on l inux have probles without .HasParent
                               if oObjTemp.HasParent then
                                 oObjTemp2 := TUniControl( oObjTemp.GetParentComponent )
                               else
                                 oObjTemp2 := nil;

                               n := StrToIntDef( ReturnNumbers( cTemp ), 0 );

                               if Pos( '%', cTemp ) > 0 then
                                  x := Trunc(( n / 100 ) * ( oObjTemp2.Width ))
                               else
                                  x := n;

                               oObjTemp.Left := x;
                            end;

                            //pos-r:5%
                            if Pos( 'pos-r:', cTemp ) > 0 then
                            begin
                               // on l inux have probles without .HasParent
                               if oObjTemp.HasParent then
                                 oObjTemp2 := TUniControl( oObjTemp.GetParentComponent )
                               else
                                 oObjTemp2 := nil;

                               n := StrToIntDef( ReturnNumbers( cTemp ), 0 );

                               if Pos( '%', cTemp ) > 0 then
                                  x := Trunc(( n / 100 ) * ( oObjTemp2.Width ))
                               else
                                  x := n;

                               oObjTemp.Left := oObjTemp2.Width - x;
                            end;

                            //pos-t:5%
                            if Pos( 'pos-t:', cTemp ) > 0 then
                            begin
                               // on l inux have probles without .HasParent
                               if oObjTemp.HasParent then
                                 oObjTemp2 := TUniControl( oObjTemp.GetParentComponent )
                               else
                                 oObjTemp2 := nil;

                               n := StrToIntDef( ReturnNumbers( cTemp ), 0 );

                               if Pos( '%', cTemp ) > 0 then
                                  x := Trunc(( n / 100 ) * ( oObjTemp2.Height ))
                               else
                                  x := n;

                               oObjTemp.Top := x;
                            end;

                            //pos-bottom:5%
                            if Pos( 'pos-b:', cTemp ) > 0 then
                            begin
                               // on l inux have probles without .HasParent
                               if oObjTemp.HasParent then
                                 oObjTemp2 := TUniControl( oObjTemp.GetParentComponent )
                               else
                                 oObjTemp2 := nil;

                               n := StrToIntDef( ReturnNumbers( cTemp ), 0 );

                               if Pos( '%', cTemp ) > 0 then
                                  x := Trunc(( n / 100 ) * ( oObjTemp2.Height ))
                               else
                                  x := n;

                               oObjTemp.Top := oObjTemp2.Height - x;
                            end;

                            // scale  scale:rcBlock34 x:45% pad:0 5 0 5
                            cTemp3 := rc_GetHintProperty( 'scale:', cTemp );
                            if cTemp3 <> '' then
                            begin
                               cTemp3 := Copy( cTemp3, 1, Pos( ' ' , cTemp3 ) - 1 );

                               oObjTemp2 := nil;

                               if cTemp3 = 'parent' then
                               begin
                                  if oObjTemp.HasParent then
                                    oObjTemp2 := TUniControl( oObjTemp.GetParentComponent )
                                  else
                                    oObjTemp2 := nil;
                               end
                               else
                                  oObjTemp2 := rc_FindControl( cTemp3, pFrame );

                               x := 0;
                               y := 0;

                               if oObjTemp2 <> nil then
                               begin
                                  if ( Pos( 'w:', cTemp ) = 0 ) and ( Pos( 'h:', cTemp ) = 0 ) then
                                  begin
                                     cTemp3 := StringReplace( cTemp , 'scale:' , '', [rfReplaceAll] );
                                     cTemp3 := Trim( StringReplace( cTemp3, oObjTemp2.Name , '', [rfReplaceAll] ) );
                                  end
                                  else
                                  begin
                                       cTemp3 := '';

                                       if ( Pos( 'w:', cTemp ) > 0 ) then
                                       begin
                                            cTemp2 := Copy( cTemp, Pos( 'w:' , cTemp ) + 2 , 300 ) + ' ';
                                            cTemp2 := Trim( Copy( cTemp2, 1, Pos( ' ' , cTemp2 ) ) );

                                            n := StrToIntDef( ReturnNumbers( cTemp2 ), 0 );

                                            iOffSet := 0;
                                            if Pos( ' off:' , cTemp ) > 0 then
                                               iOffSet := StrToIntDef( ReturnNumbers( Copy( cTemp, Pos( ' off:' , cTemp ) , Pos( ' ' , cTemp ) ) ), 0 );

                                            iWidth := oObjTemp2.Width ;

                                            if Pos( '%', cTemp2 ) > 0 then
                                               x := Trunc(( n / 100 ) * ( iWidth ))
                                            else
                                               x := StrToIntDef( cTemp2 , 0 );

                                            x := x - iOffSet;
                                       end;

                                       if ( Pos( 'h:', cTemp ) > 0 ) then
                                       begin
                                            cTemp4 := Copy( cTemp, Pos( 'h:' , cTemp ) + 2, 300 ) + ' ';
                                            cTemp4 := Trim( Copy( cTemp4, 1, Pos( ' ' , cTemp4 ) ) );

                                            cTemp3 := Trim( Copy( cTemp4, Pos( '-top' , cTemp4 ) , 300 ) + ' ' );

                                            cTemp4 := StringReplace( cTemp4, cTemp3, '' , [rfReplaceAll] );

                                            n := StrToIntDef( ReturnNumbers( cTemp4 ), 0 );

                                            iOffSet := 0;
                                            if Pos( ' off:' , cTemp ) > 0 then
                                               iOffSet := StrToIntDef( ReturnNumbers( Copy( cTemp, Pos( ' off:' , cTemp ) , Pos( ' ' , cTemp ) ) ), 0 );

                                            iHeight := oObjTemp2.Height ;

                                            if Pos( '%', cTemp4 ) > 0 then
                                               y := Trunc(( n / 100 ) * ( iHeight ) )
                                            else
                                               y := StrToIntDef( cTemp4 , 0 );

                                            y := y - iOffSet;

                                            if cTemp3 <> '' then
                                               y := y - oObjTemp.Top;
                                       end;
                                  end;
                               end
                               else
                               begin
                                    dm_rc.rc_ShowError( 'SCALE Obj:' + cTemp3 + ' not found.' );
                                    Break;
                               end;

                               if x > 0 then
                                  oObjTemp.Width := x ;

                               if y > 0 then
                                  oObjTemp.Height := y ;
                            end;

                            // conflito com novo col-attr:
                            cTemp3 := rc_GetHintProperty( 'align:', cTemp );
                            if cTemp3 <> '' then
                            begin
                               cTemp3 := Copy( cTemp3, 1, Pos( ' ' , cTemp3 ) - 1 );

                               if cTemp3 = 'parent' then
                               begin
                                  // on l inux have probles without .HasParent
                                  if oObjTemp.HasParent then
                                    oComponent := oObjTemp.GetParentComponent
                                  else
                                    oComponent := nil;

                                  oObjTemp2   := TUniControl( oComponent );
                               end
                               else
                                  oObjTemp2 := rc_FindControl( cTemp3, pFrame );

                               if oObjTemp2 <> nil then
                               begin
                                   if Pos( 'r:', cTemp ) > 0 then
                                   begin
                                      cTemp3 := Copy( cTemp, Pos( 'r:', cTemp ) + 2, 300 ) + ' ';

                                      if Pos( 'w', cTemp3 ) > 0 then
                                      begin
                                          cTemp4 := Copy( cTemp3, Pos( 'w', cTemp3 ) + 1, 10 );
                                          cTemp4 := Trim( Copy( cTemp4, 1, Pos( ' ', cTemp4 ) - 1 ) );
                                          n := StrToIntDef( cTemp4, 0 );

                                          cTemp3 := StringReplace( cTemp3, cTemp4, '', [rfReplaceAll] );
                                          iRight := oObjTemp.Width * varIIF( Pos( '-w', cTemp3 ) > 0, (-1) , 1 ) + n;
                                      end
                                      else
                                         iRight := StrToIntDef( Copy( cTemp3, 1, Pos( ' ' , cTemp3 ) - 1 ), 0 );

                                      oObjTemp.Left := oObjTemp2.Left + oObjTemp2.Width + iRight;
                                   end;

                                   if Pos( 'l:', cTemp ) > 0 then
                                   begin
                                      cTemp3 := Copy( cTemp, Pos( 'l:', cTemp ) + 2, 300 ) + ' ';

                                      if Pos( 'w', cTemp3 ) > 0 then
                                      begin
                                          cTemp4 := Copy( cTemp3, Pos( 'w', cTemp3 ) + 1, 10 );
                                          cTemp4 := Trim( Copy( cTemp4, 1, Pos( ' ', cTemp4 ) - 1 ) );
                                          n := StrToIntDef( cTemp4, 0 );

                                          cTemp3 := StringReplace( cTemp3, cTemp4, '', [rfReplaceAll] );
                                          iLeft := oObjTemp.Width * varIIF( Pos( '-w', cTemp3 ) > 0, (-1) , 1 ) + n;
                                      end
                                      else
                                         iLeft := StrToIntDef( Copy( cTemp3, 1, Pos( ' ' , cTemp3 ) - 1 ), 0 );

                                      oObjTemp.Left := oObjTemp2.Left + iLeft;
                                   end;

                                   if Pos( 't:', cTemp ) > 0 then
                                   begin
                                      cTemp3 := Copy( cTemp, Pos( 't:', cTemp ) + 2, 300 ) + ' ';

                                      if Pos( 'h', cTemp3 ) > 0 then
                                      begin
                                          cTemp4 := Copy( cTemp3, Pos( 'h', cTemp3 ) + 1, 10 );
                                          cTemp4 := Trim( Copy( cTemp4, 1, Pos( ' ', cTemp4 ) - 1 ) );
                                          n := StrToIntDef( cTemp4, 0 );

                                          cTemp3 := StringReplace( cTemp3, cTemp4, '', [rfReplaceAll] );
                                          iTop := oObjTemp.Height * varIIF( Pos( '-h', cTemp3 ) > 0, (-1) , 1 ) + n;
                                      end
                                      else
                                         iTop := StrToIntDef( Copy( cTemp3, 1, Pos( ' ' , cTemp3 ) - 1 ), 0 );

                                      oObjTemp.Top := oObjTemp2.Top + iTop;
                                   end;

                                   if Pos( 'b:', cTemp ) > 0 then
                                   begin
                                      cTemp3 := Copy( cTemp, Pos( 'b:', cTemp ) + 2, 300 ) + ' ';

                                      if Pos( 'h', cTemp3 ) > 0 then
                                      begin
                                          cTemp4 := Copy( cTemp3, Pos( 'h', cTemp3 ) + 1, 10 );
                                          cTemp4 := Trim( Copy( cTemp4, 1, Pos( ' ', cTemp4 ) - 1 ) );
                                          n := StrToIntDef( cTemp4, 0 );

                                          cTemp3 := StringReplace( cTemp3, cTemp4, '', [rfReplaceAll] );
                                          iBottom := oObjTemp.Height * varIIF( Pos( '-h', cTemp3 ) > 0, (-1) , 1 ) + n;
                                      end
                                      else
                                          iBottom := StrToIntDef( Copy( cTemp3, 1, Pos( ' ' , cTemp3 ) - 1 ), 0 );

                                      oObjTemp.Top := oObjTemp2.Top + oObjTemp2.Height + iBottom;
                                   end;
                               end
                               else
                               begin
                                    dm_rc.rc_ShowError( 'ALIGN Obj:' + cTemp3 + ' not found.' );
                                    Break;
                               end;
                            end;

                            cTemp3 := rc_GetHintProperty( 'center:', cTemp );
                            if cTemp3 <> '' then
                            begin
                               x := 0;
                               y := 0;

                               cTemp3 := Copy( cTemp3, 1, Pos( ' ' , cTemp3 ) - 1 );

                               oObjTemp2 := nil;

                               if cTemp3 = 'parent' then
                               begin
                                  // on l inux have probles without .HasParent
                                  if oObjTemp.HasParent then
                                    oComponent := oObjTemp.GetParentComponent
                                  else
                                    // v. 3.2.0.0
                                    //oComponent := nil;
                                    oComponent := oObjTemp.Owner;

                                  oObjTemp2   := TUniControl( oComponent );
                               end
                               else
                                  oObjTemp2 := rc_FindControl( cTemp3, pFrame );

                               cTemp3 := Trim (StringReplace( cTemp, 'center:' + cTemp3, '', [rfReplaceAll] ) );

                               if ( cTemp3 = 'x' ) or ( cTemp3 = 'y' ) or ( cTemp3 = 'xy' ) then
                                  rc_CenterObj( oObjTemp, oObjTemp2 , ( cTemp3 = 'y' ) or ( cTemp3 = 'xy' ), ( cTemp3 = 'x' ) or ( cTemp3 = 'xy' ) , y, x )
                               else
                               if oObjTemp2 <> nil then
                               begin
                                  if ( Pos( 'x:', cTemp ) = 0 ) and ( Pos( 'y:', cTemp ) = 0 ) then
                                  begin
                                     cTemp3 := StringReplace( cTemp , 'center:' , '', [rfReplaceAll] );
                                     cTemp3 := Trim( StringReplace( cTemp3, oObjTemp2.Name , '', [rfReplaceAll] ) );

                                     x := 0;
                                     y := 0;
                                  end
                                  else
                                  begin
                                       cTemp3 := '';

                                       if ( Pos( 'x:', cTemp ) > 0 ) then
                                       begin
                                            cTemp2 := Copy( cTemp, Pos( 'x:' , cTemp ) + 2 , 300 ) + ' ';
                                            cTemp2 := Trim( Copy( cTemp2, 1, Pos( ' ' , cTemp2 ) ) );

                                            n := StrToIntDef( ReturnNumbers( cTemp2 ), 0 );
                                            w := oObjTemp2.Width;

                                            if Pos( '%', cTemp2 ) > 0 then
                                               x := Trunc(( n / 100 ) * ( w ) )
                                            else
                                               x := StrToIntDef( cTemp2 , 0 );

                                            cTemp3 := 'x';
                                       end;

                                       if ( Pos( 'y:', cTemp ) > 0 ) then
                                       begin
                                            cTemp4 := Copy( cTemp, Pos( 'y:' , cTemp ) + 2, 300 ) + ' ';
                                            cTemp4 := Trim( Copy( cTemp4, 1, Pos( ' ' , cTemp4 ) ) );

                                            n := StrToIntDef( ReturnNumbers( cTemp4 ), 0 );
                                            h := oObjTemp2.Height;

                                            if Pos( '%', cTemp4 ) > 0 then
                                               y := Trunc(( n / 100 ) * ( h ) )
                                            else
                                               y := StrToIntDef( cTemp4 , 0 );

                                            cTemp3 := cTemp3 + 'y';
                                       end;
                                  end;
                                  rc_CenterObj( oObjTemp, oObjTemp2 , ( cTemp3 = 'y' ) or ( cTemp3 = 'xy' ), ( cTemp3 = 'x' ) or ( cTemp3 = 'xy' ) , y, x );
                               end
                               else
                               begin
                                    dm_rc.rc_ShowError( 'CENTER Obj:' + cTemp3 + ' not found.' );
                                    Break;
                               end;
                            end;
                        end;
                        iPos2 := Pos( '|' , cCmd );
                   end;
                end;
            end;
         end;
      end;
   except on e:exception do
          begin
               //UniSession.ResumeLayouts();
               dm_rc.rc_ShowSweetAlert( 'Error' , 'rc_DynamicAlignment error(' + varIIF( oObjTemp <> nil, oObjTemp.Name, '' ) + '): ' + e.Message , 'error' );
               //Abort;
          end;
   end;
  //UniSession.ResumeLayouts();
end;

procedure rc_CenterObj(pObj: TObject; pObjParent : TObject; pV : boolean; pH : boolean; pV_OffSet : integer; pH_OffSet : integer );
var
   pWidthParent,
   pHeightParent : integer;
begin
     if pObjParent = nil then
     begin
          pWidthParent  := mm.varI_ScreenWidth ;
          pHeightParent := mm.varI_ScreenHeight;
     end
     else
     begin
          pWidthParent  := TUniControl( pObjParent ).Width;
          pHeightParent := TUniControl( pObjParent ).Height;
     end;

     pWidthParent  := pWidthParent  + pH_OffSet;
     pHeightParent := pHeightParent + pV_OffSet;

     if pH then
     begin
        TUniControl( pObj ).Left := ( pWidthParent div 2 ) - ( TUniControl( pObj ).Width div 2 );
        if TUniControl( pObj ).Left < 0 then
           TUniControl( pObj ).Left := 0;
     end;

     if pV then
     begin
        TUniControl( pObj ).Top  := ( pHeightParent div 2 ) - ( TUniControl ( pObj ).Height div 2 );
        if TUniControl( pObj ).Top < 0 then
           TUniControl( pObj ).Top := 0;
     end;
end;
// v. 3.2.0.4
procedure rc_GenerateRuntimeDebugBlocksFile(pFrame: TObject);
var
  i: Integer;
  IniFile   : TIniFile;
  sCompName : string;
  oObj      : TUniContainerPanel;
begin
  IniFile := TiniFile.Create( ExtractFilePath(Application.ExeName) +'\files\rc-forms\'+ TComponent(pFrame).Name +'.ini' );
  for i := 0 to TComponent(pFrame).ComponentCount - 1 do
  begin
       if (TComponent(pFrame).Components[I] is TUniContainerPanel) then
       begin
            oObj      := TUniContainerPanel( TComponent(pFrame).Components[I] );
            sCompName := oObj.Name;
//            sLabel    := EmptyStr;
//            for j := 0 to TComponent(pFrame).ComponentCount - 1 do
//            begin
//                 if (TComponent(pFrame).Components[j] is TUniLabel) then
//                 begin
//                      if (TUniLabel(TComponent(pFrame).Components[j]).Parent.Name = sCompName ) then
//                      begin
//                           sLabel := TUniLabel(TComponent(pFrame).Components[j]).Caption;
//                           Break;
//                      end;
//                 end;
//            end;
            {escreve a linha no arquivo texto}
            if (Pos('rcBlock', sCompName ) > 0) then
            begin
                 IniFile.WriteString( sCompName , 'cmd' , RemoveLineBreaks( oObj.hint ) ) ;//+ ' ' + sLabel );
            end;
       end;
  end;
end;

procedure rc_Collapse( Sender, pForm : TObject; pObj : TUniControl );
var
   iH : integer;
   oObj : TUniControl;
   cTmp, cTmp2, cTmpTarget : string;
begin
    cTmp := rc_GetHintProperty( 'collapse:', pObj.Hint );
    if cTmp <> '' then
    begin
       oObj := TUniControl( TComponent( pForm ).FindComponent( Copy( cTmp, 1, Pos( ' ', cTmp ) - 1 ) ) );
       if oObj <> nil then
       begin
          cTmpTarget := rc_GetHintProperty( 'hr-childs:', oObj.Hint, false, true );
          if Pos( 'off-', cTmp ) > 0 then
             iH := StrToIntDef ( ReturnNumbers( rc_GetHintProperty( 'off-', cTmp, true ) ) , 0 );

          cTmp2 := rc_GetHintProperty( 'expanded-', cTmpTarget, true );
          if Pos( 'expanded-', cTmpTarget ) = 0 then
          begin
             oObj.Hint := rc_SetHintProperty( ' expanded-' + iH.ToString, 'hr-childs:' , oObj.Hint, true );
//             rc_RemoveCssClass( TUniControl(Sender), 'rc-transform-rotate-180' );//'rc-rotate-90' );
//             rc_RemoveCssClass( TUniControl(Sender), 'rc-transform-rotate-0' );//'rc-rotate-90' );
//             rc_AddCssClass( TUniControl(Sender), 'rc-transform-rotate-180' );// 'rc-rotate-90' );
             //rc_RemoveCssClass( TUniControl(Sender), 'rc-rotate-180' );
             rc_AddCssClass( TUniControl(Sender), 'rc-rotate-180' );
          end
          else
          begin
             oObj.Hint := StringReplace( oObj.Hint, ' expanded-' + cTmp2, '', [rfReplaceAll] );
             rc_RemoveCssClass( TUniControl(Sender), 'rc-transform-rotate-180' );//'rc-rotate-90' );
             //rc_RemoveCssClass( TUniControl(Sender), 'rc-transform-rotate-0' );//'rc-rotate-90' );
             //rc_AddCssClass( TUniControl(Sender), 'rc-transform-rotate-180' );// 'rc-rotate-90' );
             rc_RemoveCssClass( TUniControl(Sender), 'rc-rotate-180' );
          end;
       end;
    end;

    dm_rc.rc_ResizeBlocks( pForm, true, true );
end;

end.
